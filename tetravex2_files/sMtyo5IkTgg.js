/*!CK:3943336327!*//*1428524944,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["HsBq+"]); }

__d("CreditCardTypeEnum",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={VISA:86,MASTERCARD:77,DISCOVER:68,AMERICANEXPRESS:65,DINERSCLUB:64,JCB:74};},null);
__d("P2PChannelType",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={TRANSFER_STATUS_CHANGED:"P2P\/TransferStatusChanged"};},null);
__d("P2PPasswordProtectionParam",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={STATUS:"status"};},null);
__d("P2PPasswordProtectionStatusTypes",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={NOT_SET:0,DISABLED:1,ENABLED:2};},null);
__d("P2PPaymentCreditCardsTypes",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={SENDING:1,RECEIVING:2};},null);
__d("P2PPaymentLoggerEvent",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={ACTN_ADD_CREDIT_CARD:"Actn_AddCreditCard",ACTN_UPDATE_CREDIT_CARD:"Actn_UpdateCreditCard",ACTN_REMOVE_CREDIT_CARD:"Actn_RemoveCreditCard",ACTN_UNLOCK_CREDIT_CARD:"Actn_UnlockCreditCard",ACTN_TRANSFER_MONEY:"Actn_TransferMoney",ACTN_ACCEPT_MONEY:"Actn_AcceptMoney",ACTN_DECLINE_MONEY:"Actn_DeclineMoney",ACTN_SET_PRIMARY:"Actn_SetPrimary",ACTN_WITHDRAW_MONEY:"Actn_WithdrawMoney",ACTN_SEND_TRANSFER_MESSAGE:"Actn_SendTransferMessage",ACTN_SEND_TRANSFER_EMAIL:"Actn_SendTransferEmail",ACTN_CREATE_PAYMENT_REQUEST:"Actn_CreatePaymentRequest",ACTN_ACCEPT_PAYMENT_REQUEST:"Actn_AcceptPaymentRequest",ACTN_DECLINE_PAYMENT_REQUEST:"Actn_DeclinePaymentRequest",ACTN_AUTH_FOR_SENDER_REVIEW:"Actn_AuthForSenderReview",ACTN_COMPLETE_SENDER_REVIEW:"Actn_CompleteSenderReview",ACTN_COMPLETE_RECEIVER_REVIEW:"Actn_CompleteReceiverReview",ACTN_COMPLETE_SENDER_VERIFICATION:"Actn_CompleteSenderVerification",ACTN_COMPLETE_RECEIVER_VERIFICATION:"Actn_CancelReceiverVerification",ACTN_CANCEL_SENDER_VERIFICATION:"Actn_CancelSenderVerification",ACTN_CANCEL_RECEIVER_VERIFICATION:"Actn_CancelReceiverVerification",ACTN_CANCEL_SENDER_RISK:"Actn_CancelSenderRisk",ACTN_CANCEL_EXPIRE:"Actn_CancelExpire",ACTN_CANCEL_FOR_SAME_CARD:"Actn_CancelForSameCard",ACTN_CANCEL_BY_CUSTOMER_SERVICE:"Actn_CancelByCustomerService",ACTN_CANCEL_RECEIVER_REVIEW:"Actn_CancelReceiverReview",ACTN_CANCEL_SENDER_REVIEW:"Actn_CancelSenderReview",ACTN_ADD_PIN:"Actn_AddPIN",ACTN_UPDATE_PIN:"Actn_UpdatePIN",ACTN_REMOVE_PIN:"Actn_RemovePIN",ACTN_RESET_PIN:"Actn_ResetPIN",ACTN_ENABLE_TOUCH_ID:"Actn_EnableTouchID",ACTN_VERIFY_TOUCH_ID:"Actn_VerifyTouchID",ACTN_DISABLE_TOUCH_ID:"Actn_DisableTouchID",UI_ACTN_INITIATE_SEND:"UI_Actn_Initiate_Send",UI_ACTN_CANCEL_SEND:"UI_Actn_Send_Money_Cancelled",UI_ACTN_INITIATE_ADD_CARD:"UI_Actn_Initiate_Add_Card",UI_ACTN_CANCEL_ADD_CARD:"UI_Actn_Cancel_Add_Card",UI_ACTN_CONFIRM_CARD_DETAILS:"UI_Actn_Confirm_Card_Details",UI_ACTN_ACCEPT_WITH_CARD:"UI_Actn_Accept_With_Card",UI_ACTN_ADD_CARD_SUCCESS:"UI_Actn_Add_Card_Success",UI_ACTN_ADD_CARD_FAIL:"UI_Actn_Add_Card_Fail",UI_ACTN_CONFIRM_SEND:"UI_Actn_Confirm_Send",UI_ACTN_SEND_SUCCESS:"UI_Actn_Send_Success",UI_ACTN_SEND_MONEY_CANCELLED:"UI_Actn_Send_Money_Cancelled",UI_ACTN_SEND_FAIL:"UI_Actn_Send_Fail",UI_ACTN_INITIATE_EDIT_CARD:"UI_Actn_Initiate_Edit_Card",UI_ACTN_CANCEL_EDIT_CARD:"UI_Actn_Cancel_Edit_Card",UI_ACTN_CONFIRM_EDIT_CARD_DETAILS:"UI_Actn_Confirm_Edit_Card_Details",UI_ACTN_EDIT_CARD_SUCCESS:"UI_Actn_Edit_Card_Success",UI_ACTN_EDIT_CARD_FAIL:"UI_Actn_Edit_Card_Fail",UI_ACTN_INITIATE_REMOVE_CARD:"UI_Actn_Initiate_Remove_Card",UI_ACTN_CONFIRM_REMOVE_CARD:"UI_Actn_Confirm_Remove_Card",UI_ACTN_REMOVE_CARD_SUCCESS:"UI_Actn_Remove_Card_Success",UI_ACTN_REMOVE_CARD_FAIL:"UI_Actn_Remove_Card_Fail",UI_ACTN_INITIATE_PASSWORD_PROTECTION_NUX:"UI_Actn_Initiate_Password_Protection_NUX",UI_ACTN_OPT_IN_PASSWORD_PROTECTION_NUX:"UI_Actn_Opt_In_Password_Protection_NUX",UI_ACTN_OPT_OUT_PASSWORD_PROTECTION_NUX:"UI_Actn_Opt_Out_Password_Protection_NUX",UI_ACTN_ENABLED_PASSWORD_PROTECTION_SETTING:"UI_Actn_Enabled_Password_Protection_Setting",UI_ACTN_DISABLED_PASSWORD_PROTECTION_SETTING:"UI_Actn_Disabled_Password_Protection_Setting",UI_ACTN_SEND_CLICKED:"UI_Actn_Send_Clicked",UI_ACTN_VERIFY_CSC:"UI_Actn_Verify_CSC",UI_ACTN_CONFIRM_AMOUNT:"UI_Actn_Confirm_Amount",UI_ACTN_EDIT_CARD:"UI_Actn_Edit_Card"};},null);
__d("P2PPaymentLoggerEventFlow",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={UI_FLOW_P2P_SEND:"UI_Flow_P2P_Send",UI_FLOW_P2P_RECEIVE:"UI_Flow_P2P_Receive",UI_FLOW_P2P_SETTINGS:"UI_Flow_P2P_Settings"};},null);
__d("P2PTransferParam",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={TRANSFER_ID:"transfer_id",STATUS:"status",RISK_RESULT:"risk_result"};},null);
__d("P2PTransferStatus",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={PENDING_SENDER_MANUAL_REVIEW:1,PENDING_SENDER_VERIFICATION:2,CANCELED_SENDER_RISK:3,PENDING_RECIPIENT_NUX:4,CANCELED_DECLINED:5,PENDING_RECIPIENT_VERIFICATION:6,PENDING_RECIPIENT_MANUAL_REVIEW:7,PENDING_RECIPIENT_PROCESSING:8,PENDING_PUSH_FAIL:9,CANCELED_RECIPIENT_RISK:10,CANCELED_SYSTEM_FAIL:11,CANCELED_EXPIRED:12,COMPLETED:13,INTERMEDIATE_PROCESSING:14,PENDING_SENDER_INITED:15,CANCELED_SAME_CARD:16,PENDING_SENDER_VERIFICATION_PROCESSING:17,PENDING_RECIPIENT_VERIFICATION_PROCESSING:18};},null);
__d("StoryAttachmentStyle",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={FALLBACK:"fallback",SHARE:"share",OG_COMPOSER_SIMPLE:"og_composer_simple",SPORTS_MATCHUP:"sports_matchup",SHARE_LARGE_IMAGE:"share_large_image",PHOTO:"photo",COVER_PHOTO:"cover_photo",ALBUM:"album",NEW_ALBUM:"new_album",COUPON:"coupon",QUESTION:"question",ANSWER:"answer",OPTION:"option",GALLERY:"gallery",STREAM_PUBLISH:"stream_publish",MUSIC_AGGREGATION:"music_aggregation",ITEM_LIST:"list",HIGH_SCORE:"high_score",SCORE_LEADERBOARD:"score_leaderboard",FRIEND_LIST:"friend_list",CHECKIN:"checkin",POPULAR_OBJECTS:"popular_objects",AVATAR_LIST:"avatar_list",AVATAR:"avatar",AVATAR_WITH_VIDEO:"avatar_with_video",EVENT:"event",EXPERIENCE:"experience",LIFE_EVENT:"life_event",TRAVEL_SLIDESHOW_LIFE_EVENT:"travel_slideshow_life_event",GIFT:"gift",IMAGE_SHARE:"image_share",ANIMATED_IMAGE_SHARE:"animated_image_share",ANIMATED_IMAGE_AUTOPLAY:"animated_image_autoplay",NOTE:"note",TOPIC:"topic",FILE_UPLOAD:"file_upload",NOTIFICATION_TARGET:"notification_target",UNAVAILABLE:"unavailable",PAGE_RECOMMENDATION:"page_recommendation",PAGE_VIDEO_PLAYLIST:"page_video_playlist",VIDEO:"video",VIDEO_INLINE:"video_inline",VIDEO_AUTOPLAY:"video_autoplay",VIDEO_SHARE:"video_share",VIDEO_SHARE_HIGHLIGHTED:"video_share_highlighted",VIDEO_SHARE_YOUTUBE:"video_share_youtube",MAP:"map",OG_MAP:"og_map",PRODUCT:"product",EXTERNAL_PRODUCT:"external_product",FITNESS_COURSE:"fitness_course",APPLICATION:"application",STICKER:"sticker",EXTERNAL_OG_PRODUCT:"external_og_product",TRAVEL_LOG:"travel_log",MULTI_SHARE:"multi_share",MULTI_SHARE_NO_END_CARD:"multi_share_no_end_card",YEAR_IN_REVIEW:"year_in_review",AVATAR_LARGE_COVER:"avatar_large_cover",BROADCAST_REQUEST:"broadcast_request",COMMERCE_PRODUCT_ITEM:"commerce_product_item",COMMERCE_STORE:"commerce_store",THIRD_PARTY_PHOTO:"third_party_photo",PROMPT:"prompt",BIRTHDAY:"birthday",DONATIONS_CAMPAIGN:"donations_campaign",DONATE_PROMPT:"donate_prompt",DISCUSSION_CONVERSATION:"discussion_conversation",DISCUSSION_COMMENT:"discussion_comment",GROUP_SELL_PRODUCT_ITEM:"group_sell_product_item",GROUP_SELL_PRODUCT_ITEM_MARK_AS_SOLD:"group_sell_mark_as_sold",GAMETIME:"gametime",GROUP_REPORTED_POST_QUEUE:"group_reported_post_queue",GROUP_PENDING_POST_QUEUE:"group_pending_post_queue",GROUP_JOIN_REQUEST_QUEUE:"group_join_request_queue",GREETING_CARD:"greeting_card",LEAD_GEN:"lead_gen",ATTACHED_STORY:"attached_story",SOUVENIR:"souvenir",SLIDESHOW:"slideshow",ORION:"orion",ORION_REQUEST:"orion_request",RETAIL_ITEM:"retail_item",RETAIL_RECEIPT:"retail_receipt",INSTANT_ARTICLE:"instant_article",RETAIL_CANCELLATION:"retail_cancellation",JOIN_TOPIC_CONVERSATION:"join_topic_conversation",MOMENTS_APP_INVITATION:"moments_app_invitation",RETAIL_SHIPMENT:"retail_shipment",RETAIL_SHIPMENT_TRACKING_EVENT:"retail_shipment_tracking_event",SURVEY:"survey",MESSAGE_LOCATION:"message_location",JOB_OFFER:"job_offer",GROUP_ADD_MEMBERS:"group_add_memebers",RTC_CALL_LOG:"rtc_call_log",EVENT_CALENDAR:"event_calendar",FACEPILE:"facepile"};},null);
__d("XUIRadioList.react",["InputLabel.react","React","ReactChildren","XUIRadioInput.react","cloneWithProps"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=h,m=l.PropTypes,n=h.createClass({displayName:"XUIRadioList",propTypes:{name:m.string,onValueChange:m.func,selectedValue:m.any},render:function(){var o=i.map(this.props.children,function(p){return k(p,{name:this.props.name,onSelect:this.props.onValueChange,selectedValue:this.props.selectedValue});},this);return h.createElement("ul",h.__spread({},this.props,{name:null}),o);}});n.Item=h.createClass({displayName:"XUIRadioList.Item",propTypes:{name:m.string,onSelect:m.func,selectedValue:m.any,value:m.any,disabled:m.bool},render:function(){return (h.createElement("li",{className:this.props.className},h.createElement(g,{display:"inline"},h.createElement(j,{checked:this.props.selectedValue===this.props.value,name:this.props.name,onChange:this._handleChange,value:this.props.value,disabled:!!this.props.disabled}),h.createElement("label",null,this.props.children))));},_handleChange:function(event){this.props.onSelect&&this.props.onSelect(event.target.value);}});e.exports=n;},null);
__d("MercuryMessageObject",["MercuryActionStatus","MercuryActionType","MercuryIDs","MercuryLocalIDs","MercuryMessageClientState","MercuryMessageSourceTags","MercurySingletonMixin","MercurySourceType","MercuryTimePassed","MercurySendMessageFields","fbt","formatDate"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){b.__markCompiled&&b.__markCompiled();function s(v){"use strict";this.$MercuryMessageObject0=v;}s.prototype.constructUserGeneratedMessageObject=function(v,w,x,y,z){"use strict";var aa=t(this.$MercuryMessageObject0,h.USER_GENERATED_MESSAGE,w,x);if(typeof v=='string')v=v.replace(/^\s+/,'').replace(/\s+$/,'');aa.body=v;aa.has_attachment=false;aa.html_body=false;aa.attachments=[];aa.specific_to_list=y||[];aa.creator_info=z;return aa;};s.prototype.constructStickerMessageObject=function(v,w,x){"use strict";var y=t(this.$MercuryMessageObject0,h.USER_GENERATED_MESSAGE,w,x);y.has_attachment=true;y.html_body=false;y.attachments=[];y.sticker_id=v;y.specific_to_list=[];return y;};s.prototype.constructAttachmentMessageObject=function(v,w){"use strict";var x=t(this.$MercuryMessageObject0,h.USER_GENERATED_MESSAGE,v,w);x.attachments=[];x.specific_to_list=[];return x;};s.prototype.constructLogMessageObject=function(v,w,x,y){"use strict";var z=t(this.$MercuryMessageObject0,h.LOG_MESSAGE,v,w);z.log_message_type=x;z.log_message_data=y;return z;};s.prototype.normalizeNewMessage=function(v){"use strict";if(v.status===undefined)v.status=g.UNSENT;v.timestamp_absolute=q._("Aujourd\u2019hui");v.message_id=v.message_id||j.generateMessageID(v.timestamp);var w=i.getParticipantIDFromUserID(this.$MercuryMessageObject0);v.specific_to_list=v.specific_to_list||[];if(v.specific_to_list.length&&v.specific_to_list.indexOf(w)===-1)v.specific_to_list.push(w);if(!v.thread_id){if(v.specific_to_list.length==1){v.thread_id='user:'+this.$MercuryMessageObject0;}else if(v.specific_to_list.length==2){var x=v.specific_to_list[0]==w?v.specific_to_list[1]:v.specific_to_list[0];v.thread_id=i.getThreadIDFromParticipantID(x);}v.thread_id=v.thread_id||'root:'+v.message_id;}if(!v.specific_to_list.length){var y=i.tokenize(v.thread_id),z=y.type,aa=y.value;if(z=='user')v.specific_to_list=['fbid:'+aa,w];}if(!v[p.MANUAL_RETRY_CNT])v[p.MANUAL_RETRY_CNT]=0;};s.prototype.normalizeResendMessage=function(v){"use strict";v.status=g.RESENDING;v.timestamp=Date.now();v[p.MANUAL_RETRY_CNT]+=1;};s.prototype.normalizeAddAttachmentPlaceholder=function(v,w,x){"use strict";if(x.preview_attachments.length>0){v.has_attachment=true;v.preview_attachments=x.preview_attachments;}v.client_state=k.DO_NOT_SEND_TO_SERVER;v.status=g.RESENDING;v.upload_id=w;};function t(v,w,x,y){var z=u(x)?[l.CHAT]:[],aa=Date.now(),ba=r(new Date(aa),'g:ia'),ca={action_type:w,thread_id:y,author:i.getParticipantIDFromUserID(v),author_email:null,coordinates:null,timestamp:aa,timestamp_absolute:(new Date(aa)).toLocaleDateString(),timestamp_relative:ba,timestamp_time_passed:o.TODAY,is_unread:false,is_forward:false,is_filtered_content:false,is_spoof_warning:false,source:x,source_tags:z};return ca;}function u(v){switch(v){case n.CHAT_WEB:case n.CHAT_JABBER:case n.CHAT_IPHONE:case n.CHAT_MEEBO:case n.CHAT_ORCA:case n.CHAT_TEST:case n.CHAT:case n.DESKTOP:return true;default:return false;}}Object.assign(s,m);e.exports=s;},null);
__d("MercuryMessageActions",["CurrentUser","MercuryActionType","MercuryMessageObject","MercuryPayloadSource","MercuryServerRequests","MercurySingletonMixin"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';function m(n){this.$MercuryMessageActions0=n;this.$MercuryMessageActions1=i.getForFBID(this.$MercuryMessageActions0);this.$MercuryMessageActions2=k.getForFBID(this.$MercuryMessageActions0);}m.prototype.send=function(n,o,p){o=o||Function.prototype;this.$MercuryMessageActions1.normalizeNewMessage(n);this.$MercuryMessageActions2.handleUpdate(this.$MercuryMessageActions3(Object.assign({},n),j.CLIENT_SEND_MESSAGE));this.$MercuryMessageActions2.sendNewMessage(n,p);o(n.thread_id);};m.prototype.resend=function(n,o){var p=Object.assign({},n);this.$MercuryMessageActions1.normalizeResendMessage(p);this.send(p,(void 0),o);};m.prototype.addAttachmentPlaceholder=function(n,o,p){this.$MercuryMessageActions1.normalizeAddAttachmentPlaceholder(n,o,p);this.$MercuryMessageActions1.normalizeNewMessage(n);this.$MercuryMessageActions2.handleUpdate(this.$MercuryMessageActions3(Object.assign({},n),j.CLIENT_SEND_MESSAGE));};m.prototype.cancelAttachmentPlaceholder=function(n,o){this.$MercuryMessageActions2.handleUpdate(this.$MercuryMessageActions3({upload_id:n,upload_data:o,action_type:h.CANCEL_ATTACHMENT_PLACEHOLDER},j.CLIENT_SEND_MESSAGE));};m.prototype.confirmAttachmentPlaceholder=function(n,o){this.$MercuryMessageActions2.handleUpdate(this.$MercuryMessageActions3({upload_id:n,upload_data:o,action_type:h.CONFIRM_ATTACHMENT_PLACEHOLDER},j.CLIENT_SEND_MESSAGE));};m.addShareDataToExistingMessage=function(n,o,p,q){q=q||g.getID();m.getForFBID(q).addShareDataToExistingMessage(n,o,p);};m.prototype.addShareDataToExistingMessage=function(n,o,p){this.$MercuryMessageActions2.handleUpdate(this.$MercuryMessageActions4({server_id:n,attach_key:o,attach_data:p,action_type:h.ADD_SHARE_DATA_TO_EXISTING_MESSAGE},j.SERVER_ADD_SHARE_DATA_TO_EXISTING_MESSAGE));};m.prototype.markSpam=function(n,o){this.$MercuryMessageActions2.handleUpdate(this.$MercuryMessageActions5(n,o,h.MARK_MESSAGES_SPAM,j.CLIENT_MARK_MESSAGES_SPAM));};m.prototype["delete"]=function(n,o,p){this.$MercuryMessageActions2.handleUpdate(this.$MercuryMessageActions5(n,o,h.DELETE_MESSAGES,p||j.CLIENT_DELETE_MESSAGES));};m.prototype.$MercuryMessageActions3=function(n,o){return {actions:[n],from_client:true,payload_source:o};};m.prototype.$MercuryMessageActions4=function(n,o){return {actions:[n],from_client:false,payload_source:o};};m.prototype.$MercuryMessageActions5=function(n,o,p,q){return {actions:[{action_type:p,action_id:null,thread_id:n,message_ids:o}],from_client:true,payload_source:q};};Object.assign(m,l);e.exports=m;},null);
__d("MercuryThreadActions",["MercuryActionType","MercuryPayloadSource","MercuryServerRequests","MercurySingletonMixin","MessagingTag","merge"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';function m(n){this.$MercuryThreadActions0=n;this.$MercuryThreadActions1=i.getForFBID(this.$MercuryThreadActions0);}m.prototype.markRead=function(n,o){this.batchMarkRead([n],o);};m.prototype.batchMarkRead=function(n,o){this.$MercuryThreadActions1.handleUpdate(this.$MercuryThreadActions2(n,true,o));};m.prototype.markUnread=function(n,o){this.batchMarkUnread([n],o);};m.prototype.batchMarkUnread=function(n,o){this.$MercuryThreadActions1.handleUpdate(this.$MercuryThreadActions2(n,false,o));};m.prototype.markSeen=function(n,o){this.$MercuryThreadActions1.handleUpdate(this.$MercuryThreadActions3([n],g.MARK_THREAD_SEEN,h.CLIENT_MARK_THREAD_SEEN,{persistent:o}));};m.prototype.archive=function(n,o){this.batchArchive([n],o);};m.prototype.batchArchive=function(n,o){n.forEach(function(p){this.$MercuryThreadActions1.changeThreadArchivedStatus(p,true,o);}.bind(this));this.$MercuryThreadActions1.handleUpdate(this.$MercuryThreadActions4(n,true));};m.prototype.unarchive=function(n,o){this.batchUnarchive([n],o);};m.prototype.batchUnarchive=function(n,o){n.forEach(function(p){this.$MercuryThreadActions1.changeThreadArchivedStatus(p,false,o);}.bind(this));this.$MercuryThreadActions1.handleUpdate(this.$MercuryThreadActions4(n,false));};m.prototype.markSpam=function(n,o){this.batchMarkSpam([n],o);};m.prototype.batchMarkSpam=function(n,o){n.forEach(function(p){this.$MercuryThreadActions1.markThreadSpam(p,o);}.bind(this));this.$MercuryThreadActions1.handleUpdate(this.$MercuryThreadActions5(n,k.SPAM));};m.prototype.unmarkSpam=function(n,o){this.batchUnmarkSpam([n],o);};m.prototype.batchUnmarkSpam=function(n,o){n.forEach(function(p){this.$MercuryThreadActions1.unmarkThreadSpam(p,o);}.bind(this));this.$MercuryThreadActions1.handleUpdate(this.$MercuryThreadActions5(n,k.INBOX));};m.prototype.changeFolder=function(n,o){this.batchChangeFolder([n],o);};m.prototype.batchChangeFolder=function(n,o){n.forEach(function(p){this.$MercuryThreadActions1.changeThreadFolder(p,o);}.bind(this));this.$MercuryThreadActions1.handleUpdate(this.$MercuryThreadActions5(n,o));};m.prototype["delete"]=function(n,o){this.batchDelete([n],o);};m.prototype.batchDelete=function(n,o){n.forEach(function(p){this.$MercuryThreadActions1.deleteThread(p,o);}.bind(this));this.$MercuryThreadActions1.handleUpdate(this.$MercuryThreadActions3(n,g.DELETE_THREAD,h.CLIENT_DELETE_THREAD));};m.prototype.unmute=function(n){this.updateMuteSetting(n,0);};m.prototype.updateMuteSetting=function(n,o){this.$MercuryThreadActions1.changeMutingOnThread(n,o);this.$MercuryThreadActions1.handleUpdate(this.$MercuryThreadActions3([n],g.CHANGE_MUTE_SETTINGS,h.CLIENT_CHANGE_MUTE_SETTINGS,{mute_settings:o}));};m.prototype.addParticipants=function(n,o){this.$MercuryThreadActions1.handleUpdate(this.$MercuryThreadActions3([n],g.ADD_PARTICIPANTS,h.CLIENT_ADD_PARTICIPANTS,{participants:o}));};m.prototype.unpinThread=function(n){this.$MercuryThreadActions1.unpinThread(n);this.$MercuryThreadActions1.handleUpdate(this.$MercuryThreadActions3([n],g.UNPIN_THREAD,h.CLIENT_UNPIN_THREAD));};m.prototype.$MercuryThreadActions2=function(n,o,p){return this.$MercuryThreadActions3(n,g.CHANGE_READ_STATUS,h.CLIENT_CHANGE_READ_STATUS,{mark_as_read:o,source:p});};m.prototype.$MercuryThreadActions4=function(n,o){return this.$MercuryThreadActions3(n,g.CHANGE_ARCHIVED_STATUS,h.CLIENT_CHANGE_ARCHIVED_STATUS,{archived:o});};m.prototype.$MercuryThreadActions5=function(n,o){return this.$MercuryThreadActions3(n,g.CHANGE_FOLDER,h.CLIENT_CHANGE_FOLDER,{new_folder:o});};m.prototype.$MercuryThreadActions3=function(n,o,p,q){return {actions:n.map(function(r){return l({action_type:o,action_id:null,thread_id:r},q);}),from_client:true,payload_source:p};};Object.assign(m,j);e.exports=m;},null);
__d("MercuryAttachmentSnippetType",["keyMirror"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h=g({PHOTO:null,GIF:null,VIDEO:null,AUDIO_CLIP:null,STICKER:null,ORION:null,SHOERACK:null,SHARE:null,ERROR:null,MIXED:null});e.exports=h;},null);
__d("MercuryAttachmentSnippetRenderer",["MercuryAttachment","MercuryAttachmentSnippetType","MercuryAttachmentType","MercuryConstants","fbt"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l={getAttachmentSnippetType:function(m){if(this._hasOnlyPhotos(m))return h.PHOTO;if(this._hasOnlyAnimatedImages(m))return h.GIF;if(this._hasOnlyVideo(m))return h.VIDEO;if(this._hasAudioClip(m))return h.AUDIO_CLIP;if(this._hasSticker(m))return h.STICKER;if(this._hasOrion(m))return h.ORION;if(this._hasShoerackInvitation(m))return h.SHOERACK;if(this._hasShare(m))return h.SHARE;if(this._hasError(m))return h.ERROR;return h.MIXED;},renderAttachmentSnippetText:function(m,n,o,p){switch(m){case h.PHOTO:return this._renderPhotoAttachmentSnippetText(n,o,this._getPhotoAttachments(p));case h.GIF:return this._renderAnimatedImagesAttachmentSnippetText(n,o,this._getAnimatedImageAttachments(p));case h.VIDEO:return n?k._("Vous avez envoy\u00e9 une vid\u00e9o."):k._("{sender name} a envoy\u00e9 une vid\u00e9o.",[k.param("sender name",o)]);case h.AUDIO_CLIP:return n?k._("Vous avez envoy\u00e9 un message vocal."):k._("{name} a envoy\u00e9 un message vocal.",[k.param("name",o)]);case h.STICKER:return n?k._("Vous avez envoy\u00e9 un autocollant."):k._("{name} a envoy\u00e9 un autocollant.",[k.param("name",o)]);case h.SHOERACK:return n?k._("Vous avez envoy\u00e9 une invitation \u00e0 Moments."):k._("{sender name} vous invite \u00e0 partager des photos avec Moments.",[k.param("sender name",o)]);case h.SHARE:return n?k._("Vous avez partag\u00e9 un lien"):k._("{sender name} a partag\u00e9 un lien.",[k.param("sender name",o)]);case h.ERROR:return n?k._("Vous avez envoy\u00e9 une pi\u00e8ce jointe."):k._("{sender name} a envoy\u00e9 une pi\u00e8ce jointe.",[k.param("sender name",o)]);default:return '';}},_hasOnlyPhotos:function(m){return this._getPhotoAttachments(m).length===m.length;},_hasOnlyAnimatedImages:function(m){return this._getAnimatedImageAttachments(m).length===m.length;},_hasOnlyVideo:function(m){return (m.length===1&&m[0].attach_type===i.VIDEO);},_hasAudioClip:function(m){return !!(m.length===1&&m[0].metadata&&g.isVoiceMessage(m[0].metadata.type));},_hasSticker:function(m){return (m.length===1&&m[0].attach_type===i.STICKER);},_hasOrion:function(m){return this._hasSingleAttachmentOfShareDataType(m,j.MercurySupportedShareType.FB_ORION);},_hasShoerackInvitation:function(m){return this._hasSingleAttachmentOfShareDataType(m,j.MercurySupportedShareType.FB_SHOERACK_INVITATION);},_hasSingleAttachmentOfShareDataType:function(m,n){return (m.length===1&&m[0].share_data_type===n);},_hasShare:function(m){return (m.length===1&&m[0].attach_type===i.SHARE);},_hasError:function(m){return (m.length===1&&m[0].attach_type===i.ERROR);},_getPhotoAttachments:function(m){if(!m)return [];return m.filter(function(n){return n.attach_type===i.PHOTO;});},_getAnimatedImageAttachments:function(m){if(!m)return [];return m.filter(function(n){return n.attach_type===i.ANIMATED_IMAGE;});},_renderPhotoAttachmentSnippetText:function(m,n,o){if(o.length===1){if(m){return (k._("Vous avez envoy\u00e9 une photo."));}else return (k._("{name} a envoy\u00e9 une photo.",[k.param("name",n)]));}else if(m){return (k._({"*":"Vous avez envoy\u00e9 {num_photos} photos."},[k.param("num_photos",o.length,[0])]));}else return (k._({"*":"{name} a envoy\u00e9 {num_photos} photos."},[k.param("name",n),k.param("num_photos",o.length,[0])]));},_renderAnimatedImagesAttachmentSnippetText:function(m,n,o){if(o.length===1){if(m){return (k._("Vous avez envoy\u00e9 un GIF."));}else return (k._("{name} a envoy\u00e9 un GIF.",[k.param("name",n)]));}else if(m){return (k._("Vous avez envoy\u00e9 {num_animated_images} GIF.",[k.param("num_animated_images",o.length)]));}else return (k._("{name} a envoy\u00e9 {num_animated_images} GIF.",[k.param("name",n),k.param("num_animated_images",o.length)]));}};e.exports=l;},null);
__d("P2PMercuryAttachmentSnippet.react",["CurrentUser","Image.react","React","cx","fbt","ix"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=i,n=m.PropTypes,o=i.createClass({displayName:"P2PMercuryAttachment",propTypes:{sender:n.object,receiver:n.object,amount:n.string,currency:n.string},getDefaultProps:function(){return {sender:{},receiver:{}};},render:function(){var p;if(g.getID()===this.props.sender.id){p=k._("Vous avez envoy\u00e9 {amount} {currency}.",[k.param("currency",this.props.currency),k.param("amount",this.props.amount)]);}else p=k._("{name} vous a envoy\u00e9 {amount} {currency}.",[k.param("name",this.props.sender.name),k.param("currency",this.props.currency),k.param("amount",this.props.amount)]);return (i.createElement("span",{className:"uiIconText _3l6h _3_io"},i.createElement(h,{height:12,src:l('/images/p2p/attachment-snippet-icon.png'),width:12}),p));}});e.exports=o;},null);
__d("MercuryShareAttachmentReactShape",["React"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';var h=g,i=h.PropTypes,j=i.shape({description:i.string,media:i.shape({image:i.string,duration:i.number,playable:i.bool,source:i.string}),source:i.string,style_list:i.arrayOf(i.string),subattachments:i.array,title:i.string,properties:i.object,uri:i.string}).isRequired;e.exports=j;},null);
__d("MercuryFallbackShareAttachmentSnippet.react",["Image.react","React","cx","fbt","ix"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=h,m=l.PropTypes,n=h.createClass({displayName:"MercuryFallbackShareAttachmentSnippet",propTypes:{isSenderViewer:m.bool,senderName:m.string},render:function(){var o;if(this.props.isViewerSender){o=(j._("Vous avez partag\u00e9 un lien"));}else o=(j._("{sender name} a partag\u00e9 un lien.",[j.param("sender name",this.props.senderName)]));return (h.createElement("span",{className:"uiIconText _3l6h"},h.createElement(g,{src:k('/images/messaging/docs/generic.png')}),o));}});e.exports=n;},null);
__d("P2PMercuryShareAttachmentSnippet.react",["MercuryShareAttachmentReactShape","P2PMercuryAttachmentSnippet.react","React"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j=i.createClass({displayName:"P2PMercuryShareAttachmentSnippet",propTypes:{attachment:g},render:function(){var k=this.props.attachment?this.props.attachment.target:{};return (i.createElement(h,i.__spread({},k)));}});e.exports=j;},null);
__d("MercuryShareAttachmentSnippet.react",["Map","MercuryShareAttachmentReactShape","React","StoryAttachmentStyle","MercuryFallbackShareAttachmentSnippet.react","P2PMercuryShareAttachmentSnippet.react"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=i,l=k.PropTypes,m=new g();m.set(j.FALLBACK,b('MercuryFallbackShareAttachmentSnippet.react'));m.set(j.ORION,b('P2PMercuryShareAttachmentSnippet.react'));var n=i.createClass({displayName:"MercuryShareAttachmentSnippet",propTypes:{attachment:h,isSenderViewer:l.bool,senderName:l.string},render:function(){var o=this.props.attachment;if(!o.style_list)return null;var p=null;for(var q=0;q<o.style_list.length;q++){p=m.get(o.style_list[q]);if(p)break;}if(!p)return null;return (i.createElement(p,i.__spread({},this.props)));}});e.exports=n;},null);
__d("ImageSourceType",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();var g={PROFILE_PICTURE:'profile_picture',IMAGE:'image'};e.exports=g;},null);
__d("ImageSourceRequest",["CurrentUser","ImageSourceType","KeyedCallbackManager","PhotoResizeModeConst","MercuryServerDispatcher","arrayContains","extendArray"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();function n(){"use strict";this._request={fbid:null,type:null,width:null,height:null,resize_mode:null};this._callback=null;}n.prototype.setFBID=function(r){"use strict";this._request.fbid=r;return this;};n.prototype.setType=function(r){"use strict";if(!l([h.PROFILE_PICTURE,h.IMAGE],r))throw new TypeError('ImageSourceRequest.setType: invalid type '+r);this._request.type=r;return this;};n.prototype.setDimensions=function(r,s){"use strict";this._request.width=r;this._request.height=s;return this;};n.prototype.setResizeMode=function(r){"use strict";if(!l([j.COVER,j.CONTAIN],r))throw new TypeError('ImageSourceRequest.setResizeMode: invalid resize mode '+r);this._request.resize_mode=r;return this;};n.prototype.setCallback=function(r){"use strict";this._callback=r;return this;};n.prototype.send=function(){"use strict";if(!this._request.fbid||!this._request.width||!this._request.height||!this._request.type||!this._request.resize_mode||!this._callback)throw new Error('ImageSourceRequest: You must set all the fields');var r=p(),s=q(this._request);r.executeOrEnqueue(s,this._callback);if(r.getUnavailableResourcesFromRequest(s).length===1){k.trySend('/ajax/image_source.php',{requests:[this._request]});return true;}return false;};var o=null;function p(){if(o)return o;var r=new i();o=r;k.registerEndpoints({'/ajax/image_source.php':{request_user_id:g.getID(),mode:k.BATCH_DEFERRED_MULTI,batch_function:function(s,t){m(s.requests,t.requests);return s;},handler:function(s,t){var u=t.getData().requests;for(var v=0;v<u.length;++v)r.setResource(q(u[v]),s[v]);}}});return r;}function q(r){return [r.fbid,r.type,r.width,r.height,r.resize_mode].join('|');}e.exports=n;},null);
__d("MercuryParticipantFetcher",["MercuryIDs","MercuryPayloadSource","MercuryServerRequests","Set","ShortProfiles","setImmediate"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';function m(o){this.$MercuryParticipantFetcher0=i.getForFBID(o);this.$MercuryParticipantFetcher1=false;this.$MercuryParticipantFetcher2=new j();this.$MercuryParticipantFetcher3=new j();}m.prototype.fetch=function(o){this.$MercuryParticipantFetcher4(o);this.$MercuryParticipantFetcher5();};m.prototype.fetchMulti=function(o){o.forEach(function(p){return this.$MercuryParticipantFetcher4(p);}.bind(this));this.$MercuryParticipantFetcher5();};m.prototype.$MercuryParticipantFetcher4=function(o){if(!this.$MercuryParticipantFetcher3.has(o))this.$MercuryParticipantFetcher2.add(o);};m.prototype.$MercuryParticipantFetcher5=function(){if(this.$MercuryParticipantFetcher1||this.$MercuryParticipantFetcher2.size===0)return;this.$MercuryParticipantFetcher1=true;l(function(){this.$MercuryParticipantFetcher1=false;this.$MercuryParticipantFetcher2.forEach(function(o){return this.$MercuryParticipantFetcher3.add(o);}.bind(this));this.$MercuryParticipantFetcher6(this.$MercuryParticipantFetcher2,function(o){o.forEach(function(p){return this.$MercuryParticipantFetcher3["delete"](p.id);}.bind(this));this.$MercuryParticipantFetcher7(o);}.bind(this));this.$MercuryParticipantFetcher2.clear();}.bind(this));};m.prototype.$MercuryParticipantFetcher6=function(o,p){var q=[];o.forEach(function(r){var s=g.tokenize(r),t=s.type,u=s.value;t==='fbid'&&q.push(u);});if(q.length>0)k.getMulti(q,function(r){var s=[];for(var t in r)s.push(n(r[t],t));p(s);});};m.prototype.$MercuryParticipantFetcher7=function(o){this.$MercuryParticipantFetcher0.handleUpdate({participants:o,from_client:false,payload_source:h.SERVER_FETCH_PARTICIPANTS});};function n(o,p){var q=Object.assign({gender:o.gender,href:o.uri,id:g.getParticipantIDFromUserID(o.id||p),image_src:o.thumbSrc,name:o.name,short_name:o.firstName,employee:o.employee,is_employee_away:o.is_employee_away,type:o.type,vanity:o.vanity,is_friend:o.is_friend,is_messenger_user:o.is_messenger_user,orion_eligible:o.orionEligible,social_snippets:o.social_snippets},{});if(o.officeStatus){q.officeStatus=o.officeStatus;q.officeStatusStartDate=o.officeStatusStartDate;q.officeStatusEndDate=o.officeStatusEndDate;q.officeStatusComment=o.officeStatusComment;q.officeStatusLocation=o.officeStatusLocation;}return q;}e.exports=m;},null);
__d("MercuryParticipants",["CurrentUser","EventEmitter","ImageSourceRequest","ImageSourceType","ImmutableObject","KeyedCallbackManager","Map","MercuryAssert","MercuryIDs","MercuryParticipantFetcher","MercuryParticipantTypes","MercuryParticipantsConstants","MercuryServerRequests","PhotoResizeModeConst","Set","fbt","mapObject"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){b.__markCompiled&&b.__markCompiled();'use strict';var x='change';function y(aa){this.$MercuryParticipants0=aa;this.$MercuryParticipants1=new h();this.$MercuryParticipants2=new l();this.$MercuryParticipants3=new p(this.$MercuryParticipants0);this.$MercuryParticipants4=new m();this.$MercuryParticipants5=s.getForFBID(this.$MercuryParticipants0);this.$MercuryParticipants5.subscribe('update-participants',function(ba,ca){if(ca.participants&&ca.participants.length>0){var da={};ca.participants.forEach(function(ea){da[ea.id]=ea;});this.$MercuryParticipants6(da);}}.bind(this));}y.prototype.addListener=function(aa,ba){return this.$MercuryParticipants1.addListener(aa,ba);};y.prototype.getIDFromVanityOrFBID=function(aa){if(!aa)return;if(this.$MercuryParticipants4.has(aa))return this.$MercuryParticipants4.get(aa);if(/^\d+$/.test(aa))return o.getParticipantIDFromUserID(aa);};y.prototype.getNow=function(aa){return this.$MercuryParticipants7(aa);};y.prototype.getOrFetch=function(aa){var ba=this.$MercuryParticipants7(aa);if(!ba)this.$MercuryParticipants3.fetch(aa);return ba;};y.prototype.get=function(aa,ba){n.isParticipantID(aa);return this.$MercuryParticipants8([aa],function(ca){ba(ca[aa]);});};y.prototype.getMulti=function(aa,ba){return this.$MercuryParticipants8(aa,ba);};y.prototype.getBigImageMulti=function(aa,ba){n.allParticipantIDs(aa);var ca=r.BIG_IMAGE_SIZE;return this.$MercuryParticipants8(aa,function(da){var ea={},fa=0,ga=new u(),ha=function(la,ma){fa++;ea[la]=ma;if(fa===aa.length){ba(ea);if(ga.size>0)this.$MercuryParticipants9(ga);}}.bind(this),ia=function(la,ma){this.$MercuryParticipants2.setResource(la,k.set(this.$MercuryParticipants2.getResource(la),{big_image_src:ma.uri}));ga.add(la);ha(la,ma.uri);}.bind(this);for(var ja in da){var ka=da[ja];if(!ka.big_image_src){new i().setFBID(o.getUserIDFromParticipantID(ja)).setType(j.PROFILE_PICTURE).setDimensions(ca,ca).setResizeMode(t.COVER).setCallback(ia.bind(null,ja)).send();}else ha(ka.id,ka.big_image_src);}}.bind(this));};y.prototype.getOrderedBigImageMulti=function(aa,ba){return this.getBigImageMulti(aa,function(ca){ba(aa.map(function(da){return ca[da];}));});};y.prototype.$MercuryParticipants8=function(aa,ba){n.allParticipantIDs(aa);var ca=this.$MercuryParticipants2.executeOrEnqueue(aa,ba),da=this.$MercuryParticipants2.getUnavailableResources(ca).filter(function(ea){var fa=o.tokenize(ea),ga=fa.type,ha=fa.value;if(ga==='email'){this.$MercuryParticipantsa(ea,ha);return false;}return true;}.bind(this));this.$MercuryParticipants3.fetchMulti(da);return this.$MercuryParticipantsb(ca);};y.prototype.$MercuryParticipants7=function(aa){var ba=this.$MercuryParticipants2.getResource(aa);if(!ba){var ca=o.tokenize(aa),da=ca.type,ea=ca.value;if(da==='email')ba=this.$MercuryParticipantsa(aa,ea);}return ba;};y.prototype.$MercuryParticipantsa=function(aa,ba){var ca=new k(z(aa,ba));this.$MercuryParticipants2.setResource(aa,ca);return ca;};y.prototype.$MercuryParticipants9=function(aa){this.$MercuryParticipants1.emit(x,aa);};y.prototype.$MercuryParticipants6=function(aa){aa=w(aa,function(ba,ca){if(ba.vanity)this.$MercuryParticipants4.set(ba.vanity,ca);return new k(this.$MercuryParticipantsc(ba));}.bind(this));this.$MercuryParticipants2.addResourcesAndExecute(aa);this.$MercuryParticipants9(new u(Object.keys(aa)));};y.prototype.$MercuryParticipantsc=function(aa){var ba=aa.type===q.USER||aa.type===q.FRIEND;if(!ba)return aa;if(!aa.name&&!aa.href&&!aa.vanity){var ca=v._("Utilisateur de Facebook");aa.name=ca;aa.short_name=ca;}return aa;};y.prototype.$MercuryParticipantsb=function(aa){return {remove:function(){this.$MercuryParticipants2.unsubscribe(aa);}.bind(this)};};function z(aa,ba){return {gender:r.UNKNOWN_GENDER,href:null,id:aa,image_src:r.EMAIL_IMAGE,big_image_src:r.EMAIL_IMAGE,name:ba,short_name:ba,employee:false};}e.exports=new y(g.getID());},null);
__d("MercuryAttachmentSnippet.react",["EmoticonsList","Image.react","MercuryAttachment","MercuryAttachmentSnippetRenderer","MercuryAttachmentSnippetType","MercuryAttachmentType","MercuryIDs","P2PMercuryAttachmentSnippet.react","MercuryShareAttachmentSnippet.react","MercuryParticipants","React","StickerConstants","TextWithEmoticons.react","cx","ix","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){b.__markCompiled&&b.__markCompiled();'use strict';var w=q,x=w.PropTypes,y=q.createClass({displayName:"MercuryAttachmentSnippet",propTypes:{thread:x.object.isRequired,viewer:x.string.isRequired},componentWillMount:function(){this._ensureParticipant(this.props.thread.snippet_sender);this._setVariables(this.props);},componentWillReceiveProps:function(ba){this._ensureParticipant(ba.thread.snippet_sender);this._setVariables(ba);},componentWillUnmount:function(){this._cancelParticipantFetch();},render:function(){var ba=this._getSenderName(),ca=j.getAttachmentSnippetType(this._attachments);switch(ca){case k.PHOTO:return this._renderPhotoSnippet(ba);case k.GIF:return this._renderAnimatedImageSnippet(ba);case k.VIDEO:return this._renderVideoSnippet(ba);case k.AUDIO_CLIP:return this._renderAudioClipSnippet(ba);case k.STICKER:return this._renderStickerSnippet(ba);case k.ORION:return this._renderOrionSnippet(ba);case k.SHOERACK:return this._renderShoerackInvitationSnippet(ba);case k.SHARE:return this._renderShareSnippet(ba);case k.ERROR:return this._renderError(ba);default:return this._renderMixedSnippet(ba);}},_renderPhotoSnippet:function(ba){return this._renderSnippet(j.renderAttachmentSnippetText(k.PHOTO,this._isViewerSender,ba,this._attachments));},_renderAnimatedImageSnippet:function(ba){return this._renderSnippet(j.renderAttachmentSnippetText(k.GIF,this._isViewerSender,ba,this._attachments));},_renderVideoSnippet:function(ba){return this._renderSnippet(j.renderAttachmentSnippetText(k.VIDEO,this._isViewerSender,ba));},_renderAudioClipSnippet:function(ba){return this._renderSnippet(j.renderAttachmentSnippetText(k.AUDIO_CLIP,this._isViewerSender,ba));},_renderStickerSnippet:function(ba){if(z(this._attachments[0].metadata.stickerID)){return (q.createElement(s,{renderEmoticons:true,text:g.symbols.like}));}else return (q.createElement("span",null,j.renderAttachmentSnippetText(k.STICKER,this._isViewerSender,ba)));},_renderOrionSnippet:function(ba){return (q.createElement("span",null,q.createElement(n,q.__spread({},this._attachments[0].metadata))));},_renderShoerackInvitationSnippet:function(ba){return this._renderSnippet(j.renderAttachmentSnippetText(k.SHOERACK,this._isViewerSender,ba));},_renderShareSnippet:function(ba){if(!!this._attachments[0].share)return (q.createElement(o,{attachment:this._attachments[0].share,senderName:ba,isViewerSender:this._isViewerSender}));return this._renderSnippet(j.renderAttachmentSnippetText(k.SHARE,this._isViewerSender,ba));},_renderMixedSnippet:function(ba){return (q.createElement("span",null,this._attachments.filter(function(ca){return ca.attach_type===l.FILE||ca.attach_type===l.PHOTO||ca.attach_type===l.VIDEO;}).map(function(ca,da){return this._renderSnippet(ca.name,ca.icon_type,da);}.bind(this))));},_renderSnippet:function(ba,ca,da){var ea=i.getAttachIconClass(ca||this._attachments[0].icon_type),fa=v(ea,"uiIconText _3l6h");return (q.createElement("span",{className:fa,key:da},q.createElement(h,{src:u('/images/messaging/docs/generic.png')}),ba));},_renderError:function(ba){var ca=j.renderAttachmentSnippetText(k.ERROR,this._isViewerSender,ba);return this._renderSnippet(ca);},_setVariables:function(ba){this._viewer=ba.viewer;this._sender=ba.thread.snippet_sender;this._attachments=ba.thread.snippet_attachments;this._isViewerSender=aa(this._sender,this._viewer);},_getSenderName:function(){if(!this._sender||this._isViewerSender)return null;var ba=p.getNow(this._sender);if(!ba)return null;return ba.short_name;},_ensureParticipant:function(ba){if(!ba)return;this._cancelParticipantFetch();if(!p.getNow(ba))this._sub=p.get(ba,function(ca){return this.forceUpdate();}.bind(this));},_cancelParticipantFetch:function(){this._sub&&this._sub.remove();}});function z(ba){return (ba==r.LIKE_STICKER_ID||ba==r.HOT_LIKE_SMALL_STICKER_ID||ba==r.HOT_LIKE_MEDIUM_STICKER_ID||ba==r.HOT_LIKE_LARGE_STICKER_ID);}function aa(ba,ca){return !!(ba&&m.getParticipantIDFromUserID(ca)==ba);}e.exports=y;},null);
__d("MercuryParticipantsImage.react",["MercuryParticipants","React","SplitImage.react","areEqual"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=h,l=k.PropTypes,m=h.createClass({displayName:"MercuryParticipantsImage",_bigImageToken:(null),propTypes:{participants:l.array.isRequired,size:l.number},getInitialState:function(){return {participantImages:[]};},componentDidMount:function(){this._getParticipantImages(this.props);},componentWillReceiveProps:function(n){this._getParticipantImages(n);},componentWillUnmount:function(){this._bigImageToken&&this._bigImageToken.remove();},shouldComponentUpdate:function(n,o){return (n.size!==this.props.size||!o||!j(o.participantImages,this.state.participantImages));},render:function(){if(this.state.participantImages.length>0)return (h.createElement(i,{border:true,className:this.props.className,srcs:this.state.participantImages,size:this.props.size}));return null;},_getParticipantImages:function(n){this._bigImageToken&&this._bigImageToken.remove();(this)._bigImageToken=g.getOrderedBigImageMulti(n.participants,function(o){this.isMounted()&&this.setState({participantImages:o});}.bind(this));}});e.exports=m;},null);
__d("MercuryThreadImage.react",["ImmutableObject","MercuryIDs","MercuryParticipantsImage.react","MercuryParticipantsConstants","Pixelz.react","React","areEqual"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();'use strict';var n=l,o=n.PropTypes,p=l.createClass({displayName:"MercuryThreadImage",propTypes:{thread:o.instanceOf(g).isRequired,viewer:o.string.isRequired,size:o.number,useBackground:o.bool},shouldComponentUpdate:function(q,r){return (q.thread.image_src!==this.props.thread.image_src||!m(q.thread.participants,this.props.thread.participants)||q.size!==this.props.size||q.viewer!==this.props.viewer||q.useBackground!==this.props.useBackground);},render:function(){var q=this.props.size||j.BIG_IMAGE_SIZE,r=this.props.thread.image_src;if(r){if(this.props.useBackground)return (l.createElement("div",{style:{height:q,backgroundImage:("url("+r+")"),backgroundPosition:'50% 50%',backgroundRepeat:'no-repeat',backgroundSize:'cover',width:q}}));return (l.createElement(k,{height:q,resizeMode:'cover',src:r,width:q}));}var s=h.getParticipantIDFromUserID(this.props.viewer),t=this.props.thread.participants.filter(function(v){return v!==s;}),u=[];if(!t.length){u=[s];}else if(t.length==1){u=t;}else u=t.slice(0,3);return (l.createElement(i,{participants:u,size:q}));}});e.exports=p;},null);
__d("MercuryParticipantListRenderer",["fbt"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';function h(){this.$MercuryParticipantListRenderer0=false;this.$MercuryParticipantListRenderer1=false;this.$MercuryParticipantListRenderer2=false;this.$MercuryParticipantListRenderer3=function(r){return this.$MercuryParticipantListRenderer1?r.short_name:r.name;}.bind(this);}h.prototype.renderParticipantList=function(r){var s=r.map(this.$MercuryParticipantListRenderer3);switch(s.length){case 0:return i(this.$MercuryParticipantListRenderer0);case 1:return j(s);case 2:return this.$MercuryParticipantListRenderer2?l(s):k(s);case 3:return this.$MercuryParticipantListRenderer2?n(s):m(s);default:return this.$MercuryParticipantListRenderer2?p(s):o(s);}};h.prototype.setIsNewThread=function(r){this.$MercuryParticipantListRenderer0=r;return this;};h.prototype.setNameRenderer=function(r){this.$MercuryParticipantListRenderer3=r;return this;};h.prototype.setUseShortName=function(r){this.$MercuryParticipantListRenderer1=r;return this;};h.prototype.setUseAndSeparator=function(r){this.$MercuryParticipantListRenderer2=r;return this;};function i(r){if(r){return (g._("Nouveau message"));}else return (g._("Aucun participant"));}function j(r){return r[0];}function k(r){return (g._("{participant1}, {participant2}",[g.param("participant1",r[0]),g.param("participant2",r[1])]));}function l(r){return (g._("{participant1} et {participant2}",[g.param("participant1",r[0]),g.param("participant2",r[1])]));}function m(r){return (g._("{participant1}, {participant2}, {participant3}",[g.param("participant1",r[0]),g.param("participant2",r[1]),g.param("participant3",r[2])]));}function n(r){return (g._("{participant1}, {participant2} et {participant3}",[g.param("participant1",r[0]),g.param("participant2",r[1]),g.param("participant3",r[2])]));}function o(r){return (g._("{participant1}, {participant2}, {participant3}, {others_link}",[g.param("participant1",r[0]),g.param("participant2",r[1]),g.param("participant3",r[2]),g.param("others_link",q(r.length-3))]));}function p(r){return (g._("{participant1}, {participant2} et {others_link}",[g.param("participant1",r[0]),g.param("participant2",r[1]),g.param("others_link",q(r.length-2))]));}function q(r){if(r>1){return (g._({"*":"{others_count} autres personnes"},[g.param("others_count",r,[0])]));}else return (g._("1 autre"));}e.exports=h;},null);
__d("MercuryThreadTitle.react",["MercuryIDs","MercuryParticipantListRenderer","MercuryParticipants","React","TextWithEmoticons.react","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=j,n=m.PropTypes,o=j.createClass({displayName:"MercuryThreadTitle",propTypes:{isNewThread:n.bool,thread:n.object.isRequired,viewer:n.string.isRequired,showUnreadCount:n.bool,useShortName:n.bool,useAndSeparator:n.bool},getDefaultProps:function(){return {isNewThread:false,showUnreadCount:false,useShortName:false,useAndSeparator:false};},getInitialState:function(){return {participantNames:''};},componentDidMount:function(){this._renderParticipantsList(this.props);},componentWillReceiveProps:function(p){this._renderParticipantsList(p);},render:function(){return (j.createElement("span",{className:this.props.className},this.props.thread.name?this._renderThreadTitle():this.state.participantNames));},getTitle:function(){return this.state.participantNames;},_renderThreadTitle:function(){var p=this.props.thread,q=j.createElement(k,{renderEmoticons:true,renderEmoji:true,text:p.name});if(!p.unread_count||!this.props.showUnreadCount)return q;return this._renderTitleWithUnreadCount(q,p.unread_count);},_renderParticipantsList:function(p){if(p.thread.name)return;var q=g.getParticipantIDFromUserID(p.viewer),r=p.thread.participants;if(r.length>1)r=r.filter(function(s){return s!=q;});i.getMulti(r,function(s){if(!this.isMounted())return;var t=r.map(function(w){return s[w];}),u=new h().setUseShortName(this.props.useShortName).setUseAndSeparator(this.props.useAndSeparator).setIsNewThread(this.props.isNewThread).renderParticipantList(t),v=(p.showUnreadCount&&p.thread.unread_count)?this._renderTitleWithUnreadCount(u,p.thread.unread_count):u;this.setState({participantNames:v});}.bind(this));},_renderTitleWithUnreadCount:function(p,q){return (l._("{conversation-title} ({unread-count})",[l.param("conversation-title",p),l.param("unread-count",q)]));}});e.exports=o;},null);
__d("WebMessengerThreadPermalinks",["MercuryIDs","MessagingTag","URI","WebMessengerPermalinkConstants","WWWBase","requireWeak"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m={getThreadURI:function(q,r,s){if(g.isCanonical(q)){n(q,r,s);}else o(q,r,s);}};function n(q,r,s){var t=new i(k.uri),u=g.tokenize(q).value;t.setPath(p(s)+'/'+u);r&&r(t.toString());}function o(q,r,s){l(['MercuryServerRequests'],function(t){var u=t.get();u.getServerThreadID(q,function(v){var w=new i(k.uri);w.setPath(j.getURIPathForThreadID(v,p(s)));r&&r(w.toString());});});}function p(q){var r=j.BASE_PATH;if(q&&q!=h.INBOX)r+='/'+q;return r;}e.exports=m;},null);
__d("MercuryThreadInfo",["CurrentUser","MercuryThreadMode"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';var i={canReply:function(k){return !!(k.is_subscribed&&k.mode!=h.OBJECT_ORIGINATED&&!k.has_email_participant&&!k.read_only&&(k.recipients_loadable||k.recipients_loadable===(void 0)));},getMuteSetting:function(k){return (k.mute_settings&&k.mute_settings[j(g.getID())]);},isMuted:function(k){return i.getMuteSetting(k)!==(void 0);}};function j(k){return k+'@facebook.com';}e.exports=i;},null);
__d("MercuryMessages",["AsyncRequest","BanzaiODS","CurrentUser","EventEmitter","ImmutableObject","LogHistory","Map","MercuryActionStatus","MercuryActionType","MercuryAssert","MercuryAttachmentType","MercuryLogMessageType","MercuryMessageClientState","MercuryPayloadSource","MercurySingletonMixin","MercuryMessageActions","MercuryMessageIDs","RangedCallbackManager","MercurySendMessageFields","MercuryServerRequests","MercuryThreadActions","MercuryThreadInformer","MercuryThreads","URI","copyProperties","debounceAcrossTransitions","invariant","isMessengerDotComURI","mergeDeep"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia){b.__markCompiled&&b.__markCompiled();'use strict';var ja=new j(),ka=l.getInstance('mercury_messages');function la(xa,ya){var za=ya;if(xa._localIdsMap[ya])za=xa._localIdsMap[ya];return xa._messages.get(za);}function ma(xa){switch(xa){case t.UNKNOWN:case t.SERVER_INITIAL_DATA:case t.SERVER_FETCH_THREAD_INFO:case t.SERVER_THREAD_SYNC:return true;}return false;}function na(xa,ya){if(!xa._threadsToMessages[ya])xa._threadsToMessages[ya]=new x(function(za){return la(xa,za).timestamp;},function(za,ab){return ab-za;});return xa._threadsToMessages[ya];}function oa(xa,ya,za){ya.forEach(function(ab){var bb=na(xa,ab);bb.setReachedEndOfArray();xa._emitReorderedChange(ab,za);});}function pa(xa){this._fbid=xa;this._messageActions=v.getForFBID(this._fbid);this._serverRequests=z.getForFBID(this._fbid);this._threadInformer=ba.getForFBID(this._fbid);this._threads=ca.getForFBID(this._fbid);this._threadActions=aa.getForFBID(this._fbid);this._didChange=false;this._failedHistoryFetchThreads={};this._threadsToMessages={};this._localTitanMessagesCount={};this._messages=new m();this._attachmentData={};this._messagesNeedingAttachmentData={};this._localIdsMap={};this._serverRequests.subscribe('update-messages',function(ya,za){var ab=(za.actions||[]).filter(function(cb){var db=cb.action_type,eb=((cb.is_forward||cb.thread_id)&&(db==o.LOG_MESSAGE||db==o.USER_GENERATED_MESSAGE||db==o.SEND_MESSAGE||db==o.DELETE_THREAD||db==o.DELETE_MESSAGES||db==o.MARK_MESSAGES_SPAM)),fb=((cb.upload_id&&cb.upload_data)&&(db==o.CANCEL_ATTACHMENT_PLACEHOLDER||db==o.CONFIRM_ATTACHMENT_PLACEHOLDER)),gb=(db==o.ADD_SHARE_DATA_TO_EXISTING_MESSAGE&&(cb.server_id&&cb.attach_key&&cb.attach_data));return (eb||fb||gb);}),bb=ma(za.payload_source);this.handleUpdates(ab,bb,za.payload_source,za.from_client);if(za.end_of_history)oa(this,za.end_of_history,za.payload_source);if(this._didChange){this._didChange=false;ja.emit('change');}}.bind(this));ka.debug('constructed',{fbid:this._fbid});}ea(pa.prototype,{getMessagesFromIDs:function(xa){return (xa||[]).map(la.bind(null,this)).filter(function(ya){return ya;});},hasLoadedNMessages:function(xa,ya){var za=na(this,xa);return za.hasReachedEndOfArray()||za.getCurrentArraySize()>=ya;},hasLoadedExactlyNMessages:function(xa,ya){var za=na(this,xa);return za.getCurrentArraySize()==ya;},clearMercuryInternalState_DO_NOT_USE:function(){this._failedHistoryFetchThreads={};this._threadsToMessages={};this._localTitanMessagesCount={};this._messages=new m();this._attachmentData={};this._messagesNeedingAttachmentData={};this._localIdsMap={};},getThreadMessagesRange:function(xa,ya,za,ab,bb,cb){var db=na(this,xa),eb=function(mb){ab(qa(this,mb));}.bind(this),fb=db.executeOrEnqueue(ya,za,eb),gb=db.getUnavailableResources(fb),hb=this._failedHistoryFetchThreads[xa];if(gb.length&&!hb){var ib=db.getCurrentArraySize(),jb=this._localTitanMessagesCount[xa]||0,kb=ib-jb,lb=gb.length+jb;ka.debug('fetch_missing_messages',{threadID:xa,offset:ya,limit:za,missingIndices:gb,messageCount:ib,localMessageCount:jb});this._serverRequests.fetchThreadMessages(xa,kb,lb,bb,cb);}else this._failedHistoryFetchThreads[xa]=false;return fb;},getThreadMessagesRangeNow:function(xa,ya,za){var ab=na(this,xa),bb=[];for(var cb=ya;cb<ya+za;cb++){var db=ab.getResourceAtIndex(cb),eb=la(this,db);eb&&bb.push(eb);}return bb;},getThreadMessagesSinceTimestamp:function(xa,ya){var za=na(this,xa),ab=za.getElementsUntil(ya);return qa(this,ab);},hasLoadedAllMessages:function(xa){return na(this,xa).hasReachedEndOfArray();},getCurrentlyLoadedMessages:function(xa){var ya=na(this,xa).getAllResources();return qa(this,ya);},unsubscribe:function(xa,ya){p.isThreadID(ya);var za=na(this,ya);za.unsubscribe(xa);},_addNewMessage:function(xa,ya){ta(this,ya);ua(ya);this._messages.set(xa,new k(ya));},_updateMessage:function(xa,ya,za){var ab=k.set(ya,za);this._messages.set(xa,ab);return ab;},_addAttachmentData:function(xa,ya,za){var ab=la(this,xa);if(ab){var bb=ab.attachments.indexOf(ya);if(bb!=-1){this._updateMessage(xa,ab,{attachments:ab.attachments.map(function(cb,db){return (db===bb)?za:cb;})});this._emitUpdatedChange(ab.thread_id,ab.message_id,'attach');}}else{if(!this._attachmentData[xa])this._attachmentData[xa]=[];this._attachmentData[xa].push({attach_key:ya,data:za});}},_shouldSortOutOfOrderMessages:function(xa,ya,za){if(xa==t.CLIENT_CHANNEL_MESSAGE){var ab=this.getThreadMessagesSinceTimestamp(ya,za);if(ab.length>0){h.bumpEntityKey('chat.web','channel.messages_reordered');return true;}}return false;},_preprocessIncomingAction:function(xa,ya){var za=xa.action_type;if(ya==t.CLIENT_CHANNEL_MESSAGE&&za==o.USER_GENERATED_MESSAGE&&xa.threading_id&&this._localIdsMap[xa.threading_id]===xa.threading_id){xa.client_message_id=xa.threading_id;xa.status=n.SUCCESS;xa.action_type=o.SEND_MESSAGE;za=xa.action_type;}if(ya===t.CLIENT_CHANNEL_MESSAGE&&za==o.USER_GENERATED_MESSAGE){var ab=this._threads.getThreadMetaNow(xa.thread_id);if(ab&&ab.folder)xa.folder=ab.folder;}return xa;},handleUpdates:function(xa,ya,za,ab){var bb,cb={},db={};for(var eb=0;eb<xa.length;eb++){var fb=this._preprocessIncomingAction(xa[eb],za),gb=fb.action_type,hb=la(this,fb.message_id);if(fb.is_forward||za==t.SERVER_SEARCH){if(!this._messages.has(fb.message_id))this._addNewMessage(fb.message_id,fb);continue;}else if(fb.client_state===s.SEND_TO_SERVER){this._addNewMessage(fb.message_id,fb);continue;}else if(gb==o.SEND_MESSAGE){var ib=fb.client_message_id;if(ib&&this._localIdsMap[ib]&&fb.status){var jb=la(this,ib),kb=jb.status;if(jb.status==n.SUCCESS)continue;if(fb.status==n.UNCONFIRMED){if(!db[fb.thread_id])db[fb.thread_id]=[];db[fb.thread_id].push(ib);}else if(!cb[fb.thread_id])cb[fb.thread_id]=[];this._updateLocalMessage(fb);if(typeof kb!==(void 0)||fb.status==n.FAILED_UNKNOWN_REASON||fb.status==n.UNABLE_TO_CONFIRM||fb.status==n.SUCCESS||fb.status==n.ERROR)this._emitUpdatedChange(fb.thread_id,la(this,ib).message_id,za);}continue;}else if(gb==o.DELETE_THREAD){na(this,fb.thread_id).removeAllResources();continue;}else if(gb==o.DELETE_MESSAGES){this._deleteMessages(fb.thread_id,fb.message_ids,za);continue;}else if(gb===o.MARK_MESSAGES_SPAM){this._markMessagesSpam(fb,za);continue;}else if((fb.threading_id&&this._localIdsMap[fb.threading_id])||(hb&&!hb.is_forward)){if(hb&&fb.ranges&&fb.ranges.length>0){var lb=hb.message_id;this._updateMessage(this._localIdsMap[lb]||lb,hb,{ranges:xa.ranges});this._emitUpdatedChange(hb.thread_id,hb.message_id,'link_shim');}continue;}else if(gb===o.CONFIRM_ATTACHMENT_PLACEHOLDER){this._confirmAttachmentPlaceholder(fb.upload_id,fb.upload_data);continue;}else if(gb===o.CANCEL_ATTACHMENT_PLACEHOLDER){this._cancelAttachmentPlaceholder(fb.upload_id,fb.upload_data);continue;}else if(gb===o.ADD_SHARE_DATA_TO_EXISTING_MESSAGE){this._addAttachmentData(fb.server_id,fb.attach_key,fb.attach_data);continue;}else{if(za===t.CLIENT_SEND_MESSAGE){this._localIdsMap[fb.message_id]=fb.message_id;if(fb.thread_id=='root:'+fb.message_id)na(this,fb.thread_id).setReachedEndOfArray();}if(gb==o.LOG_MESSAGE&&fb.log_message_type==r.SERVER_ERROR)this._failedHistoryFetchThreads[fb.thread_id]=true;if(fb.client_state===s.DO_NOT_SEND_TO_SERVER&&fb.upload_id)this._uploadMessages[fb.upload_id]=fb;if(!cb[fb.thread_id])cb[fb.thread_id]=[];cb[fb.thread_id].push(fb.message_id);this._addNewMessage(fb.message_id,fb);if(fb.threading_id&&fb.threading_id!=fb.message_id)w.addServerID(fb.threading_id,fb.message_id);if(fb[y.MANUAL_RETRY_CNT]>0){bb=na(this,fb.thread_id);bb.resortResources([fb.message_id]);this._emitReorderedChange(fb.thread_id,t.CLIENT_SEND_MESSAGE);}ya=ya||this._shouldSortOutOfOrderMessages(za,fb.thread_id,fb.timestamp);if(!ya)this._emitReceivedChange(la(this,fb.message_id));continue;}}for(var mb in cb){bb=na(this,mb);var nb=bb.getAllResources(),ob=nb.filter(function(qb){var rb=this._messages.get(qb);return rb.action_type==o.LOG_MESSAGE&&rb.log_message_type==r.SERVER_ERROR;}.bind(this));bb.removeResources(ob);if(ab)ra(this,mb,cb[mb]);if(ya){bb.addResources(cb[mb]);this._emitReorderedChange(mb,za);}else bb.addResourcesWithoutSorting(cb[mb].reverse(),0);this._threadInformer.updatedThread(mb);}var pb=Object.keys(db);if(pb.length)this._serverRequests.requestMessageConfirmation(db);ka.debug('handle_updates',{localMessageCounts:ia(this._localTitanMessagesCount)});},isFirstMessage:function(xa){var ya=na(this,xa.thread_id);if(ya.getCurrentArraySize()===0)return false;var za=ya.getResourceAtIndex(ya.getCurrentArraySize()-1),ab=la(this,za).message_id,bb=la(this,xa.message_id).message_id;return ya.hasReachedEndOfArray()&&ab==bb;},_markMessagesSpam:function(xa,ya){var za=xa,ab=za.thread_id,bb=za.message_ids;if(!bb.length)return;this._deleteIndividualMessages(ab,bb,ya);this._serverRequests.markMessagesSpam(ab,bb);},_deleteMessages:function(xa,ya,za){if(!ya.length)return;this._deleteIndividualMessages(xa,ya,za);if(za!==t.CLIENT_CHANNEL_MESSAGE)this._serverRequests.deleteMessages(xa,ya);},_deleteIndividualMessages:function(xa,ya,za){var ab=ya.map(function(cb){return la(this,cb).message_id;},this),bb=na(this,xa);bb.removeResources(ab);this._emitReorderedChange(xa,za);},_updateLocalMessage:function(xa){var ya=la(this,xa.client_message_id),za={};za.status=xa.status;if(xa.status===n.SUCCESS||xa.error_data)za.error_data=xa.error_data;var ab=xa.message_id,bb=xa.client_message_id;if(this._messages.has(ab)){this._updateMessage(ab,ya,za);return false;}if(xa.timestamp)za.timestamp=xa.timestamp;if(xa.log_message_data)za.log_message_data=xa.log_message_data;if(xa.ranges&&xa.ranges.length){ua(xa);za.ranges=xa.ranges;}if(xa.attachments&&xa.attachments.length){za.raw_attachments=null;za.attachments=xa.attachments;ta(this,za,ab);}this._localIdsMap[bb]=ab;w.addServerID(bb,ab);var cb=this._updateMessage(ab,ya,za);this._messages.set(bb,new k());if(sa(cb))this._localTitanMessagesCount[cb.thread_id]--;return true;},getNumberLocalMessages:function(xa){return this._localTitanMessagesCount[xa]||0;},_uploadMessages:{},_confirmAttachmentPlaceholder:function(xa,ya){var za=this._popPendingAttachmentMessage(xa,ya);this._serverRequests.sendNewMessage(za);},_cancelAttachmentPlaceholder:function(xa,ya){var za=this._popPendingAttachmentMessage(xa,ya);this._deleteIndividualMessages(za.thread_id,[za.message_id]);if(this._localTitanMessagesCount[za.thread_id])this._localTitanMessagesCount[za.thread_id]--;},_popPendingAttachmentMessage:function(xa,ya){var za=this._uploadMessages[xa];ga(za);za.image_ids=ya.image_ids;za.file_ids=ya.file_ids;za.audio_ids=ya.audio_ids;za.gif_ids=ya.gif_ids;za.client_state=s.SEND_TO_SERVER;delete this._uploadMessages[xa];return za;},_emitUpdatedChange:function(xa,ya,za){this._didChange=true;this._threadInformer.updatedMessage(xa,ya,za);},_emitReceivedChange:function(xa){this._didChange=true;this._threadInformer.receivedMessage(xa);},_emitReorderedChange:function(xa,ya){this._didChange=true;this._threadInformer.reorderedMessages(xa,ya);}});Object.assign(pa,u,{addListener:function(xa,ya){return ja.addListener(xa,ya);}});function qa(xa,ya){var za=ya.map(la.bind(null,xa));return za.reverse();}function ra(xa,ya,za){var ab=za.filter(function(bb){return sa(la(xa,bb));});if(!xa._localTitanMessagesCount[ya])xa._localTitanMessagesCount[ya]=0;xa._localTitanMessagesCount[ya]+=ab.length;}function sa(xa){var ya=xa.action_type;if(ya==o.USER_GENERATED_MESSAGE)return true;switch(xa.log_message_type){case r.SUBSCRIBE:case r.UNSUBSCRIBE:case r.SERVER_ERROR:case r.LIVE_LISTEN:return false;default:return true;}}function ta(xa,ya,za){za=za||ya.message_id;var ab=xa._attachmentData[za];if(ab){ab.forEach(function(bb){var cb=ya.attachments.indexOf(bb.attach_key);if(cb!==-1)ya.attachments[cb]=bb.data;});delete xa._attachmentData[za];}else if(!ya.is_forward&&va(xa,ya)){xa._messagesNeedingAttachmentData[za]=true;wa(xa);}}function ua(xa){if(!xa.ranges)return;xa.ranges.forEach(function(ya){if(!ya.entity||ya.entity.external||!ya.entity.url)return;var za=new da(ya.entity.url);if(ha(da.getRequestURI())&&!za.getDomain()){za.setProtocol('https').setDomain('www.facebook.com');ya.entity.url=za.toString();}});}function va(xa,ya){if(!ya||!ya.attachments)return false;for(var za=0;za<ya.attachments.length;za++){var ab=ya.attachments[za];if(typeof ab==='string'&&ab.indexOf(q.SHARE)===0)return true;}var bb=ya.forward_message_ids||[];for(za=0;za<bb.length;za++){var cb=la(xa,bb[za]);if(va(xa,cb))return true;}return false;}var wa=fa(function(xa){var ya={};for(var za in xa._messagesNeedingAttachmentData){var ab=la(xa,za);if(va(xa,ab))ya[za]=true;}var bb=Object.keys(ya);if(bb.length){var cb={message_ids:bb};if(xa._fbid!=i.getID())cb.request_user_id=xa._fbid;new g('/ajax/mercury/attachments/fetch_shares.php').setData(cb).setAllowCrossPageTransition(true).send();}xa._messagesNeedingAttachmentData={};},0,this);e.exports=pa;},null);
__d("MercuryChannelHandler",["Arbiter","ChannelConstants","MercuryActionType","MercuryGlobalActionType","MercuryMessages","MercuryPayloadSource","MercuryServerRequests","MercurySingletonMixin","MercuryThreadInformer","MercuryViewer","MessagingEvent","MessagingReliabilityLogger","MessagingTag","PresenceUtil","copyProperties","mixin"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){b.__markCompiled&&b.__markCompiled();var w=v(n);for(var x in w)if(w.hasOwnProperty(x))z[x]=w[x];var y=w===null?null:w.prototype;z.prototype=Object.create(y);z.prototype.constructor=z;z.__superConstructor__=w;function z(aa){"use strict";this.$MercuryChannelHandler0=aa;this.$MercuryChannelHandler1=m.getForFBID(this.$MercuryChannelHandler0);this.$MercuryChannelHandler2=o.getForFBID(this.$MercuryChannelHandler0);this.$MercuryChannelHandler3=k.getForFBID(this.$MercuryChannelHandler0);this.$MercuryChannelHandler4=[];}z.prototype.getInstanceFBID=function(){"use strict";return this.$MercuryChannelHandler0;};z.prototype.$MercuryChannelHandler5=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler6(aa)||!ba.obj||!ba.obj.message){r.addEntry('channel_receive','invalid_data');return;}var ca=ba.obj.message,da=ca.other_user_fbid?ca.other_user_fbid:ca.thread_fbid,ea={author:ca.mercury_author_id,author_email:ca.mercury_author_email,body:ca.body,subject:ca.subject,has_attachment:ca.has_attachment,attachments:ca.attachments,html_body:ca.html_body,thread_id:ca.tid,thread_fbid:ca.thread_fbid,other_user_fbid:ca.other_user_fbid,message_id:ca.mid,coordinates:ca.mercury_coordinates,is_spoof_warning:ca.is_spoof_warning,ranges:ca.ranges,source:ca.mercury_source,source_tags:ca.mercury_source_tags,threading_id:ca.threading_id,timestamp:ca.timestamp,timestamp_absolute:ca.timestamp_absolute,timestamp_relative:ca.timestamp_relative,timestamp_time_passed:ca.timestamp_time_passed,action_type:i.USER_GENERATED_MESSAGE,is_unread:ca.is_unread,is_forward:false,forward_count:ca.forward_count||ca.forward,forward_message_ids:ca.forward_msg_ids,location_text:ca.location_text,folder:ba.obj.folder};if("sync_id" in ca){ea.sync_id=ca.sync_id;}else ea.action_id=ca.action_id;var fa=[u({},ea)];fa=fa.concat(ca.forward_actions||[]);var ga=l.CLIENT_CHANNEL_MESSAGE;this.$MercuryChannelHandler1.handleUpdateWaitForThread({actions:fa,payload_source:ga},da);if(!ca.is_unread&&p.isViewer(ca.mercury_author_id)){var ha={};ha[da]=ba.obj.folder;this.$MercuryChannelHandler7(this.__getMessagingPayloadType(),{obj:{event:q.READ,thread_fbids:ca.thread_fbid?[ca.thread_fbid]:[],other_user_fbids:ca.other_user_fbid?[ca.other_user_fbid]:[],folder_info:ha,timestamp:ca.timestamp}});}r.addEntry('channel_receive','success',[da,ea.message_id,t.getSessionID()]);};z.prototype.$MercuryChannelHandler7=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler6(aa)||!ba.obj||(!ba.obj.thread_fbids&&!ba.obj.other_user_fbids))return;var ca=[],da=ba.obj.event==q.READ;(ba.obj.thread_fbids||[]).forEach(function(ea){ca.push({action_type:i.CHANGE_READ_STATUS,action_id:null,thread_fbid:ea,mark_as_read:da,timestamp:ba.obj.timestamp||0,folder:ba.obj.folder_info[ea]});});(ba.obj.other_user_fbids||[]).forEach(function(ea){ca.push({action_type:i.CHANGE_READ_STATUS,action_id:null,other_user_fbid:ea,mark_as_read:da,timestamp:ba.obj.timestamp||0,folder:ba.obj.folder_info[ea]});});this.$MercuryChannelHandler1.handleUpdate({actions:ca,payload_source:l.CLIENT_CHANNEL_MESSAGE});};z.prototype.$MercuryChannelHandler8=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler6(aa)||!ba.obj||!(ba.obj.thread_fbids||ba.obj.other_user_fbids))return;var ca=[];(ba.obj.thread_fbids||[]).forEach(function(da){ca.push({action_type:i.DELETE_THREAD,action_id:null,thread_fbid:da});});(ba.obj.other_user_fbids||[]).forEach(function(da){ca.push({action_type:i.DELETE_THREAD,action_id:null,other_user_fbid:da});});this.$MercuryChannelHandler1.handleUpdate({actions:ca,payload_source:l.CLIENT_CHANNEL_MESSAGE});};z.prototype.$MercuryChannelHandler9=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler6(aa)||!ba.obj||(!ba.obj.thread_fbids&&!ba.obj.other_user_fbids)||!ba.obj.mids)return;var ca=ba.obj.thread_fbids.length?ba.obj.thread_fbids[0]:null,da=ba.obj.other_user_fbids.length?ba.obj.other_user_fbids[0]:null,ea={action_type:i.DELETE_MESSAGES,action_id:null,thread_fbid:ca,other_user_fbid:da,message_ids:ba.obj.mids};this.$MercuryChannelHandler1.handleUpdate({actions:[ea],threads:[ba.obj.updated_thread],payload_source:l.CLIENT_CHANNEL_MESSAGE});};z.prototype.$MercuryChannelHandlera=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler6(aa)||!ba.obj||!ba.obj.folder)return;var ca={action_type:j.MARK_ALL_READ,action_id:ba.obj.action_id,folder:ba.obj.folder};this.$MercuryChannelHandler1.handleUpdate({global_actions:[ca]});};z.prototype.$MercuryChannelHandlerb=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler6(aa)||(!ba.obj.thread_fbids&&!ba.obj.other_user_fbids))return;var ca=l.CLIENT_CHANNEL_MESSAGE;(ba.obj.thread_fbids||[]).forEach(function(da){var ea={action_type:i.CHANGE_ARCHIVED_STATUS,action_id:null,thread_fbid:da,other_user_fbid:null,archived:ba.obj.state};this.$MercuryChannelHandler1.handleUpdateWaitForThread({actions:[u({},ea)],payload_source:ca},da);},this);(ba.obj.other_user_fbids||[]).forEach(function(da){var ea={action_type:i.CHANGE_ARCHIVED_STATUS,action_id:null,thread_fbid:null,other_user_fbid:da,archived:ba.obj.state};this.$MercuryChannelHandler1.handleUpdateWaitForThread({actions:[u({},ea)],payload_source:ca},da);},this);};z.prototype.$MercuryChannelHandlerc=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler6(aa)||(!ba.obj.thread_fbids&&!ba.obj.other_user_fbids))return;var ca=l.CLIENT_CHANNEL_MESSAGE,da;(ba.obj.thread_fbids||[]).forEach(function(ea){if(ba.obj.event==q.TAG){da=ba.obj.tag;}else da=ba.obj.marked_as_spam?s.SPAM:s.INBOX;var fa={action_type:i.CHANGE_FOLDER,action_id:null,thread_fbid:ea,other_user_fbid:null,new_folder:da};this.$MercuryChannelHandler1.handleUpdateWaitForThread({actions:[u({},fa)],payload_source:ca},ea);},this);(ba.obj.other_user_fbids||[]).forEach(function(ea){if(ba.obj.event==q.TAG){da=ba.obj.tag;}else da=ba.obj.marked_as_spam?s.SPAM:s.INBOX;var fa={action_type:i.CHANGE_FOLDER,action_id:null,other_user_fbid:ea,thread_fbid:null,new_folder:da};this.$MercuryChannelHandler1.handleUpdateWaitForThread({actions:[u({},fa)],payload_source:ca},ea);},this);};z.prototype.$MercuryChannelHandlerd=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler6(aa)||!ba.obj.tag)return;switch(ba.obj.tag){case s.ACTION_ARCHIVED:this.$MercuryChannelHandlerb(aa,ba);break;case s.INBOX:case s.OTHER:this.$MercuryChannelHandlerc(aa,ba);break;}};z.prototype.__markAsSeen=function(aa,ba){"use strict";if(!this.$MercuryChannelHandlere(aa)||!ba.obj||!ba.obj.seen_timestamp)return;this.$MercuryChannelHandler1.handleUpdate({message_counts:[{seen_timestamp:ba.obj.seen_timestamp,folder:s.INBOX}],unseen_thread_fbids:[{thread_fbids:[],other_user_fbids:[],folder:s.INBOX}],payload_source:l.CLIENT_CHANNEL_MESSAGE});};z.prototype.__updateModelsFromMercuryPayload=function(aa,ba){"use strict";if(!this.$MercuryChannelHandlerf(aa)||!ba.obj)return;this.$MercuryChannelHandler2.synchronizeInforms(function(){var ca=ba.obj,da=[];(ca.actions||[]).forEach(function(ea){var fa=i.USER_GENERATED_MESSAGE;if(ea.action_type==i.LOG_MESSAGE){var ga=l.CLIENT_CHANNEL_MESSAGE,ha;ha=ea.other_user_fbid||ea.thread_fbid;this.$MercuryChannelHandler1.handleUpdateWaitForThread({actions:[u({},ea)],payload_source:ga},ha);}else if(ea.action_type!=fa)da.push(ea);},this);ca.actions=da;ca.payload_source=l.CLIENT_CHANNEL_MESSAGE;this.$MercuryChannelHandler1.handleUpdate(ca);}.bind(this));};z.prototype.$MercuryChannelHandlerg=function(aa,ba){"use strict";this.$MercuryChannelHandler1.handleRoger(ba.obj);};z.prototype.$MercuryChannelHandlerh=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler6(aa)||!ba.obj||ba.obj.mute_settings===(void 0)||(!ba.obj.thread_fbid&&!ba.obj.other_user_fbid))return;var ca=i.CHANGE_MUTE_SETTINGS,da=[{action_type:ca,action_id:null,thread_fbid:ba.obj.thread_fbid,other_user_fbid:ba.obj.other_user_fbid,mute_settings:ba.obj.mute_settings}];this.$MercuryChannelHandler1.handleUpdate({actions:da,payload_source:l.CLIENT_CHANNEL_MESSAGE});};z.prototype.__handleMessagingPayload=function(aa,ba){"use strict";switch(ba.obj.event){case q.DELIVER:this.$MercuryChannelHandler5(aa,ba);break;case q.READ:case q.UNREAD:this.$MercuryChannelHandler7(aa,ba);break;case q.READ_ALL:this.$MercuryChannelHandlera(aa,ba);break;case q.DELETE:this.$MercuryChannelHandler8(aa,ba);break;case q.DELETE_MESSAGES:this.$MercuryChannelHandler9(aa,ba);break;case q.TAG:this.$MercuryChannelHandlerd(aa,ba);break;case q.REPORT_SPAM:this.$MercuryChannelHandlerc(aa,ba);break;case q.READ_RECEIPT:this.$MercuryChannelHandlerg(aa,ba);break;case q.CHANGE_MUTE_SETTINGS:this.$MercuryChannelHandlerh(aa,ba);break;}};z.prototype.getRouting=function(){"use strict";return {mercury:this.__updateModelsFromMercuryPayload,messaging:this.__handleMessagingPayload,inbox:this.__markAsSeen};};z.prototype.__getMessagingPayloadType=function(){"use strict";return h.getArbiterType('messaging');};z.prototype.__getMercuryPayloadType=function(){"use strict";return h.getArbiterType('mercury');};z.prototype.__getInboxPayloadType=function(){"use strict";return h.getArbiterType('inbox');};z.prototype.$MercuryChannelHandler6=function(aa){"use strict";return (aa==this.__getMessagingPayloadType());};z.prototype.$MercuryChannelHandlerf=function(aa){"use strict";return (aa==this.__getMercuryPayloadType());};z.prototype.$MercuryChannelHandlere=function(aa){"use strict";return (aa==this.__getInboxPayloadType());};z.prototype.turnOn=function(){"use strict";if(!this.$MercuryChannelHandler4.length){var aa=this.getRouting();for(var ba in aa)this.$MercuryChannelHandler4.push(g.subscribe(h.getArbiterType(ba),aa[ba].bind(this)));}return this;};z.prototype.turnOff=function(){"use strict";if(this.$MercuryChannelHandler4.length){this.$MercuryChannelHandler4.forEach(g.unsubscribe);this.$MercuryChannelHandler4=[];}return this;};u(z,n);e.exports=z;},null);
__d("MercuryRoger",["Arbiter","ArbiterMixin","immutable","JSLogger","MercuryActionStatus","mapObject","MercuryServerRequests","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();var m=b('MercuryServerRequests').get(),n=b('MercuryThreads').get(),o={},p=[],q=k.SUCCESS,r={getSeenBy:function(u,v){if(!u)return [];var w=[],x=o[u.thread_id];if(!x)return w;x.forEach(function(y,z){if(s(u,y,z,v))w.push(z);});return w;},wasSeenByAll:function(u){if(!u)return false;var v=o[u.thread_id];if(!v)return false;return v.every(function(w,x){return s(u,w,x);});},getSeenTimestamps:function(u){var v=o[u];if(!v){v=i.OrderedMap();o[u]=v;}return v;},getSeenTimestamp:function(u,v){var w=o[u];return w?w.get(v):null;}};Object.assign(r,h);function s(u,v,w,x){return !!(v>u.timestamp&&(u.status===(void 0)||u.status===q)&&(!x||w!=u.author));}m.subscribe('update-roger',function(u,v){for(var w in v){var x=o[w]||i.OrderedMap();x=x.withMutations(function(y){for(var z in v[w]){var aa=n.getThreadMetaNow(w);if(aa&&aa.participants)if(aa.participants.indexOf(z)==-1){p.push(t(o));continue;}var ba=y.get(z),ca=v[w][z];if(!ba||ca>ba)y.set(z,ca);}});o[w]=x.sort();}v&&r.inform('change',v);});g.subscribe(j.DUMP_EVENT,function(u,v){v.bad_read_receipts={receipts:p};});function t(u){return l(u,function(v){return v.toJS();});}e.exports=r;},null);
__d("MercuryDelayedRoger",["ArbiterMixin","LiveTimer","MercuryActionStatus","MercuryConfig","MercuryRoger","setTimeoutAcrossTransitions","MercuryMessages","MercuryThreadInformer","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();var m=b('MercuryMessages').get(),n=b('MercuryThreadInformer').get(),o=b('MercuryThreads').get(),p={},q={},r=j['roger.seen_delay'],s={getSeenBy:function(y,z){if(q[y])return [];return k.getSeenBy(t(y),z);},wasSeenByAll:function(y){if(q[y])return false;return k.wasSeenByAll(t(y));}};Object.assign(s,g);function t(y){if(!p[y]){var z=o.getThreadMetaNow(y);if(z)p[y]={thread_id:y,author:z.participants[0],timestamp:z.timestamp};}return p[y];}function u(y){var z=false;m.getThreadMessagesRange(y,0,1,function(aa){var ba=aa[0];if(!ba)return;var ca=ba.timestamp;if(ba.action_id||ba.status==i.SUCCESS)ca-=h.getServerTimeOffset();var da=s.getSeenBy(y);if(q[y]){clearTimeout(q[y]);delete q[y];}var ea=ca+r,fa=ea-Date.now();if(fa>0)q[y]=l(function(){delete q[y];v(y);},fa);p[y]=ba;var ga=s.getSeenBy(y);if(da.length||ga.length)z=true;});return z;}function v(y){var z={};z[y]=true;w(z);}function w(y){s.inform('state-changed',y);s.inform('change');}function x(event,y){var z={};for(var aa in y)if(u(aa))z[aa]=true;for(var ba in z){w(z);break;}}k.subscribe('change',function(y,z){for(var aa in z)!q[aa]&&v(aa);});n.subscribe('messages-received',x);n.subscribe('messages-reordered',x);n.subscribe('messages-updated',x);e.exports=s;},null);
__d("P2PActionConstants",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();'use strict';var g={CREDIT_CARDS_UPDATED:'credit_cards_updated',CREDIT_CARD_ADDED:'credit_card_added',CREDIT_CARD_ADDED_ERROR:'credit_card_added_error',CREDIT_CARD_DELETED:'credit_card_deleted',CREDIT_CARD_DELETED_ERROR:'credit_card_deleted_error',CREDIT_CARD_UPDATED:'credit_card_updated',CREDIT_CARD_UPDATED_ERROR:'credit_card_updated_error',PRESET_CREDIT_CARD_UPDATED:'preset_credit_card_updated',PRESET_CREDIT_CARD_UPDATED_ERROR:'preset_credit_card_updated_error',CREDIT_CARD_VERIFIED:'credit_card_verified',CREDIT_CARD_VERIFIED_ERROR:'credit_card_verified_error',TRANSFERS_UPDATED:'transfers_updated',TRANSFERS_UPDATED_ERROR:'transfers_updated_error',NUX_TRANSFERS_UPDATED:'nux_transfers_updated',TRANSFER_ADDED:'transfer_added',TRANSFER_ADDED_ERROR:'transfer_added_error',TRANSFER_UPDATED:'transfer_updated',TRANSFER_UPDATED_ERROR:'transfer_updated_error',TRANSFER_ACCEPTED:'transfer_accepted',TRANSFER_DECLINED:'transfer_declined'};e.exports=g;},null);
__d("P2PDispatcher",["Dispatcher"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';e.exports=new g();},null);
__d("P2PActions",["P2PActionConstants","P2PDispatcher"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';var i={updateCreditCards:function(j){h.dispatch({type:g.CREDIT_CARDS_UPDATED,data:j});},addCreditCard:function(j){h.dispatch({type:g.CREDIT_CARD_ADDED,data:j});},addCreditCardError:function(j){h.dispatch({type:g.CREDIT_CARD_ADDED_ERROR,data:j});},updatePresetCreditCard:function(j){h.dispatch({type:g.PRESET_CREDIT_CARD_UPDATED,data:j});},updatePresetCreditCardError:function(j){h.dispatch({type:g.PRESET_CREDIT_CARD_UPDATED_ERROR,data:j});},updateCreditCard:function(j){h.dispatch({type:g.CREDIT_CARD_UPDATED,data:j});},updateCreditCardError:function(j){h.dispatch({type:g.CREDIT_CARD_UPDATED_ERROR,data:j});},deleteCreditCard:function(j){h.dispatch({type:g.CREDIT_CARD_DELETED,data:j});},deleteCreditCardError:function(j){h.dispatch({type:g.CREDIT_CARD_DELETED_ERROR,data:j});},verifyCreditCard:function(j){h.dispatch({type:g.CREDIT_CARD_VERIFIED,data:j});},verifyCreditCardError:function(j){h.dispatch({type:g.CREDIT_CARD_VERIFIED_ERROR,data:j});},updateTransfers:function(j){h.dispatch({type:g.TRANSFERS_UPDATED,data:j});},updateTransfersError:function(j){h.dispatch({type:g.TRANSFERS_UPDATED_ERROR,data:j});},updateNUXTransfers:function(j){h.dispatch({type:g.NUX_TRANSFERS_UPDATED,data:j});},transferAdded:function(j){h.dispatch({type:g.TRANSFER_ADDED,data:j});},transferAddedError:function(j){h.dispatch({type:g.TRANSFER_ADDED_ERROR,data:j});},transferUpdated:function(j){h.dispatch({type:g.TRANSFER_UPDATED,data:j});},transferUpdatedError:function(j){h.dispatch({type:g.TRANSFER_UPDATED_ERROR,data:j});},transferAccepted:function(){h.dispatch({type:g.TRANSFER_ACCEPTED});},transferDeclined:function(j){h.dispatch({type:g.TRANSFER_DECLINED,data:j});}};e.exports=i;},null);
__d("P2PAPIUtils",["CreditCardFormParam","fbt","guid","merge"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k={genRequestID:function(){return 'id:'+i()+':'+Date.now();},getUncaughtErrorMessage:function(){return (h._("Une erreur s\u2019est produite. Veuillez r\u00e9essayer plus tard."));},prepareCardMutationData:function(l){var m={},n=l[g.CARD_NUMBER].replace(/ /g,''),o=l[g.CARD_EXPIRATION].split('/');m[g.CARD_NUMBER]=n;m[g.MONTH]=o[0];m[g.YEAR]=o[1];m[g.CARD_EXPIRATION]={};m[g.CARD_EXPIRATION][g.MONTH]=m[g.MONTH];m[g.CARD_EXPIRATION][g.YEAR]=m[g.YEAR];return j(l,m);}};e.exports=k;},null);
__d("XP2PCreditCardDeleteController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/credit_cards\/_delete\/",{});},null);
__d("XP2PCreditCardUpdateController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/credit_cards\/_update\/",{});},null);
__d("XP2PCreditCardCreateController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/credit_cards\/_create\/",{});},null);
__d("XP2PCreditCardsController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/credit_cards\/",{type:{type:"Int",defaultValue:1}});},null);
__d("XP2PPasswordProtectionStatusController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/password_protection_status\/",{});},null);
__d("XP2PPasswordProtectionStatusUpdateController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/password_protection_status\/_update\/",{});},null);
__d("XP2PPresetCreditCardSetController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/preset_credit_card\/_set\/",{});},null);
__d("XP2PTransactionsCreateController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/transactions\/_create\/",{});},null);
__d("XP2PTransactionsController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/transactions\/",{since:{type:"Int"}});},null);
__d("XP2PTransactionsDeclineController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/transactions\/_decline\/",{});},null);
__d("XP2PTransactionsCancelController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/transactions\/_cancel\/",{});},null);
__d("XP2PCreditCardVerifyController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/credit_cards\/_verify\/",{});},null);
__d("P2PAPI",["AsyncRequest","CreditCardFormParam","P2PActions","P2PAPIUtils","P2PPasswordProtectionParam","P2PPaymentCreditCardsTypes","P2PTransferParam","ImmutableObject","URI","XP2PCreditCardDeleteController","XP2PCreditCardUpdateController","XP2PCreditCardCreateController","XP2PCreditCardsController","XP2PPasswordProtectionStatusController","XP2PPasswordProtectionStatusUpdateController","XP2PPresetCreditCardSetController","XP2PTransactionsCreateController","XP2PTransactionsController","XP2PTransactionsDeclineController","XP2PTransactionsCancelController","XP2PCreditCardVerifyController","emptyFunction"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba){b.__markCompiled&&b.__markCompiled();'use strict';var ca={getAllCreditCards:function(){var da=(s.getURIBuilder()).getURI();new g().setData({type:l.SENDING}).setURI(da).setMethod('GET').setReadOnly(true).setHandler(function(ea){var fa=ea.getPayload();if(!fa.error)i.updateCreditCards(fa);}.bind(this)).send();},createTransaction:function(da){var ea=(w.getURIBuilder()).getURI(),fa={},ga=da.formData,ha=da.success||ba,ia=da.error||ba;fa[h.CREDENTIAL_ID]=ga[h.CREDENTIAL_ID];fa.amount=ga.amount;fa.receiver_id=ga.receiverId;fa.offline_threading_id=j.genRequestID();new g().setData(fa).setMethod('POST').setURI(ea).setHandler(function(ja){var ka=ja?ja.getPayload():{};if(ka.error){ia(ka.error);}else{ha(ka);this.getAllCreditCards();}}.bind(this)).setErrorHandler(function(){ia({message:j.getUncaughtErrorMessage()});}.bind(this)).send();},addCreditCard:function(da){var ea=(r.getURIBuilder()).getURI().getPath(),fa=o('/ajax/payment/token_proxy.php').addQueryData('tpe',ea);da=j.prepareCardMutationData(da);var ga=new n(da);new g().setData(da).setMethod('POST').setURI(fa).setHandler(function(ha){var ia=ha.getPayload(),ja={};if(!ia.errors){ja[h.CREDENTIAL_ID]=ia[h.CARD_FBID];ja.isPreset=ia.isPreset;ja.isVerified=ia.isVerified;ja.passwordProtection=ia.passwordProtection;ga=n.set(ga,ja);i.addCreditCard(ga);}else i.addCreditCardError(Object.assign({requestID:ga.requestID},ia));}.bind(this)).setErrorHandler(function(){i.addCreditCardError({requestID:ga.requestID,errors:{general:{message:j.getUncaughtErrorMessage()}}});}.bind(this)).send();},getTransactions:function(da){da=da||{};var ea={},fa=da,ga=(x.getURIBuilder()).getURI(),ha=new n(fa);if(fa.since)ea.since=fa.since;return new g().setData(ea).setURI(ga).setMethod('GET').setReadOnly(true).setHandler(function(ia){var ja=ia.getPayload();if(!ja.error){i.updateTransfers(ja);}else i.updateTransfersError(Object.assign({requestID:ha.requestID},ja));}.bind(this)).setErrorHandler(function(){i.updateTransfersError({error:{message:j.getUncaughtErrorMessage()},requestID:ha.requestID});}.bind(this)).send();},getNUXTransactions:function(){var da=(new Date()),ea=Math.round((da.setDate(da.getDate()-15))/1000),fa=(x.getURIBuilder()).getURI();return new g().setData({since:ea}).setURI(fa).setMethod('GET').setReadOnly(true).setHandler(function(ga){var ha=ga.getPayload();if(!ha.error)i.updateNUXTransfers(ha);}.bind(this)).send();},updatePresetCreditCard:function(da){var ea=(v.getURIBuilder()).getURI();new g().setData(da).setURI(ea).setMethod('POST').setHandler(function(fa){var ga=fa.getPayload();if(!ga.error){i.updatePresetCreditCard(Object.assign({},ga,{requestID:da.requestID}));i.transferAccepted();}else i.updatePresetCreditCardError(Object.assign({},ga,{requestID:da.requestID}));}.bind(this)).setErrorHandler(function(){i.updatePresetCreditCardError({error:{message:j.getUncaughtErrorMessage()},requestID:da.requestID});}.bind(this)).send();},updateCreditCard:function(da){var ea=(q.getURIBuilder()).getURI().getPath(),fa=o('/ajax/payment/token_proxy.php').addQueryData('tpe',ea);da=j.prepareCardMutationData(da);var ga=new n(da);new g().setData(da).setMethod('POST').setURI(fa).setHandler(function(ha){var ia=ha.getPayload();if(!ia.errors){i.updateCreditCard(ga);}else i.updateCreditCardError(Object.assign({},ia,{requestID:ga.requestID}));}.bind(this)).setErrorHandler(function(){i.updateCreditCardError({errors:{general:{message:j.getUncaughtErrorMessage()}},requestID:ga.requestID});}.bind(this)).send();},deleteCreditCard:function(da){var ea=(p.getURIBuilder()).getURI();new g().setData(da).setMethod('POST').setURI(ea).setHandler(function(fa){var ga=fa.getPayload();if(!ga.error){i.deleteCreditCard(Object.assign({},ga,{requestID:da.requestID}));}else i.deleteCreditCardError(Object.assign({},ga,{requestID:da.requestID}));}.bind(this)).setErrorHandler(function(){i.deleteCreditCardError({error:{message:j.getUncaughtErrorMessage()},requestID:da.requestID});}.bind(this)).send();},getPasswordProtectionSetting:function(da){var ea=(t.getURIBuilder()).getURI(),fa=da.success||ba,ga=da.error||ba;new g().setURI(ea).setMethod('GET').setReadOnly(true).setHandler(function(ha){var ia=ha?ha.getPayload():[];if(ia.error){ga();}else fa(ia);}.bind(this)).setErrorHandler(function(){ga();}.bind(this)).send();},setPasswordProtectionSetting:function(da){var ea=(u.getURIBuilder()).getURI(),fa=da.formData,ga=da.success||ba,ha=da.error||ba,ia={};ia[k.STATUS]=fa[k.STATUS];new g().setData(ia).setURI(ea).setMethod('POST').setHandler(function(ja){var ka=ja?ja.getPayload():{};if(ka.error){ha(ka.error);}else ga();}.bind(this)).setErrorHandler(function(){ha();}.bind(this)).send();},declineTransaction:function(da){var ea=(y.getURIBuilder()).getURI(),fa=da.formData,ga=da.success||ba,ha=da.error||ba,ia={};ia[m.TRANSFER_ID]=fa[m.TRANSFER_ID];new g().setData(ia).setURI(ea).setMethod('POST').setHandler(function(ja){var ka=ja?ja.getPayload():{},la={};if(ka.error){ha(ka.error);}else{ga();la[m.TRANSFER_ID]=ia[m.TRANSFER_ID];i.transferDeclined(la);}}.bind(this)).setErrorHandler(function(){ha();}.bind(this)).send();},cancelTransaction:function(da){var ea=(z.getURIBuilder()).getURI(),fa=da.formData,ga=da.success||ba,ha=da.error||ba,ia={};ia[m.TRANSFER_ID]=fa[m.TRANSFER_ID];new g().setData(ia).setURI(ea).setMethod('POST').setHandler(function(ja){var ka=ja?ja.getPayload():{};if(ka.error){ha(ka.error);}else ga();}.bind(this)).setErrorHandler(function(){ha();}.bind(this)).send();},verifyCreditCard:function(da){var ea=(aa.getURIBuilder()).getURI().getPath(),fa=o('/ajax/payment/token_proxy.php').addQueryData('tpe',ea);new g().setData(da).setMethod('POST').setURI(fa).setHandler(function(ga){var ha=ga.getPayload();if(!ha.error){i.verifyCreditCard(Object.assign({},ha,{requestID:da.requestID}));}else i.verifyCreditCardError(Object.assign({},ha,{requestID:da.requestID}));}.bind(this)).setErrorHandler(function(){i.verifyCreditCardError({error:{message:j.getUncaughtErrorMessage()},requestID:da.requestID});}.bind(this)).send();}};e.exports=ca;},null);
__d("P2PNUXRendererUtils",["MercuryConstants","CurrentUser","ImmutableObject","MercuryAttachmentType","P2PTransferParam","P2PTransferStatus","StoryAttachmentStyle"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();'use strict';var n=g.MercurySupportedShareType,o={getTransferFromMessage:function(p){var q,r;if(!p||!p.attachments||!p.attachments.length)return;r=p.attachments[0];if(this.isShareAttachment(r)){q=r.share.target;}else if(r.share_data_type===n.FB_ORION)q=r.metadata;if(q)q=new i(q);return q;},isShareAttachment:function(p){return !!(typeof p!=='string'&&p.attach_type==j.SHARE&&p.share&&p.share.style_list&&p.share.style_list.indexOf(m.ORION)>=0);},doesNUXNeedCreditCards:function(p){var q=h.getID()===p.sender.id;return (!q&&p[k.STATUS]===l.PENDING_RECIPIENT_NUX);},isRecipientActionableStatus:function(p){var q=p[k.STATUS],r=h.getID()===p.sender.id;return (!r&&(q===l.PENDING_RECIPIENT_NUX||q===l.PENDING_RECIPIENT_VERIFICATION||q===l.PENDING_PUSH_FAIL));}};e.exports=o;},null);
__d("P2PButton.react",["P2PEnvironment","MessengerDialogButton.react","React","XUIButton.react"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=i.createClass({displayName:"P2PButton",render:function(){var l=g.messengerdotcom,m=l?h:j,n=this.props.type;if(!n)n=this.props.type==='confirm'?'primary':'secondary';var o=l?'default':this.props.use,p=Object.assign({},this.props,{type:n,use:o});return (i.createElement(m,i.__spread({},p),this.props.children));}});e.exports=k;},null);
__d("P2PDialog.react",["LayerFadeOnHide","P2PEnvironment","MessengerDialog.react","React","XUIDialog.react","emptyFunction"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=j,n=m.PropTypes,o=j.createClass({displayName:"P2PDialog",propTypes:{onToggle:n.func,shown:n.bool,width:n.number},getDefaultProps:function(){return {onToggle:l,repositionOnUpdate:false,shown:true,width:400};},componentDidUpdate:function(){if(this.props.repositionOnUpdate)setTimeout(function(){if(this.isMounted()&&this.refs.dialog&&this.refs.dialog.layer)this.refs.dialog.layer.updatePosition();}.bind(this));},render:function(){var p=h.messengerdotcom,q=p?i:k;return (j.createElement(q,j.__spread({behaviors:{LayerFadeOnHide:g}},this.props,{ref:"dialog"}),this.props.children));}});e.exports=o;},null);
__d("P2PDialogFooter.react",["P2PEnvironment","MessengerDialogFooter.react","React","XUIDialogFooter.react","cloneWithProps","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=i.createClass({displayName:"P2PDialogFooter",render:function(){var n=g.messengerdotcom,o=n?h:j,p,q=this.props.children;if(n){p=i.Children.count(this.props.children);q=i.Children.map(this.props.children,function(r,s){if(!r)return null;return k(r,{className:"_4ec0",type:s===0&&p===2?'secondary':'primary'});});}return (i.createElement(o,i.__spread({},this.props),q));}});e.exports=m;},null);
__d("P2PDialogTitle.react",["P2PEnvironment","MessengerDialogHeader.react","React","XUIDialogTitle.react"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=i.createClass({displayName:"P2PDialogTitle",render:function(){var l=g.messengerdotcom,m=l?h:j;return (i.createElement(m,i.__spread({},this.props),this.props.children));}});e.exports=k;},null);
__d("P2PLoadingMask.react",["React","XUISpinner.react","cx"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j=g,k=j.PropTypes,l=g.createClass({displayName:"P2PLoadingMask",propTypes:{visible:k.bool},getDefaultProps:function(){return {visible:false};},render:function(){if(!this.props.visible)return null;return (g.createElement("div",{className:"_3de"},g.createElement(h,{background:"dark",size:"large",className:"_3df"}),g.createElement("div",{className:"_3dg"})));}});e.exports=l;},null);
__d("P2PText.react",["MessengerText.react","P2PEnvironment","React","XUIGrayText.react"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=i,l=k.PropTypes,m=i.createClass({displayName:"P2PText",propTypes:{type:l.oneOf(['primary','secondary']).isRequired},render:function(){var n=h.messengerdotcom,o=n?g:j,p=this.props,q=p.type,r=this.props;if(!n)r=Object.assign({},this.props,{display:this.props.display||'block',shade:q==='primary'?'dark':'light',size:'small'});return (i.createElement(o,i.__spread({},r),this.props.children));}});e.exports=m;},null);
__d("P2PCreditCard",["CreditCardFormParam","CreditCardTypeEnum","PaymentMethodUtils","fbt","ix"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l={visa:{image:k('/images/payments/icons/visa.png'),imageLarge:k('/images/payments/icons/visa-lg.png'),name:'Visa'},mc:{image:k('/images/payments/icons/mc.png'),imageLarge:k('/images/payments/icons/mc-lg.png'),name:'MasterCard'},disc:{image:k('/images/payments/icons/disc.png'),imageLarge:k('/images/payments/icons/disc-lg.png'),name:'Discover'},jcb:{image:k('/images/payments/icons/jcb.png'),imageLarge:k('/images/payments/icons/jcb-lg.png'),name:'JCB'},amex:{image:k('/images/payments/icons/amex.png'),imageLarge:k('/images/payments/icons/amex-lg.png'),name:'American Express'},unknown:{image:k('/images/brands/credit_card/credit_32.png'),imageLarge:k('/images/brands/credit_card/credit_32.png'),name:j._("Type de carte inconnu")}};function m(n){this.setCredentialId(n[g.CREDENTIAL_ID]);this.setCardType(n[g.CARD_TYPE]);this.setCreditCardNumber(n[g.CARD_NUMBER]);this.setSelected(n.selected);this.setZipCode(n[g.ZIP]);this.setCSC(n[g.CSC]);this.setExp(n[g.CARD_EXPIRATION]);this.setIsPreset(n.isPreset);this.setIsVerified(n.isVerified);this.setIsMobileVerified(n.isMobileVerified);}m.prototype.getCreditCardNumber=function(){return this[g.CARD_NUMBER];};m.prototype.setCreditCardNumber=function(n){n=n.replace(/ /g,'');this.setCardProviderProps(this[g.CARD_TYPE],n);n=n.substr(n.length-4);this[g.CARD_NUMBER]=n;};m.prototype.setCardProviderProps=function(n,o){var p=this.$P2PCreditCard0(n,o);if(l[p]){this.setImage(l[p].image);this.setImageLarge(l[p].imageLarge);this.setName(l[p].name);}};m.prototype.getExp=function(){return this[g.CARD_EXPIRATION];};m.prototype.getExpFormatted=function(){var n=this[g.CARD_EXPIRATION];return n?n[g.MONTH]+'/'+n[g.YEAR]:'';};m.prototype.getExpFormattedShort=function(){var n=this[g.CARD_EXPIRATION],o='';if(n&&n[g.MONTH]&&n[g.YEAR]){o=n[g.MONTH]+'/';if(n[g.YEAR].length===4){o+=n[g.YEAR].substr(2);}else o+=n[g.YEAR];}return o;};m.prototype.setExp=function(n){if(!n)return;var o,p,q={};q[g.MONTH]=n[g.MONTH];q[g.YEAR]=n[g.YEAR];if(q[g.MONTH]&&q[g.MONTH].length===1)q[g.MONTH]='0'+q[g.MONTH];if(q[g.YEAR]&&q[g.YEAR].length===2){o=(new Date()).getFullYear()+'';p=o.substr(0,2);q[g.YEAR]=p+q[g.YEAR];}this[g.CARD_EXPIRATION]=q;};m.prototype.getCSC=function(){return this[g.CSC];};m.prototype.setCSC=function(n){this[g.CSC]=n;};m.prototype.getZipCode=function(){return this[g.ZIP];};m.prototype.setZipCode=function(n){this[g.ZIP]=n;};m.prototype.getSelected=function(){return this.$P2PCreditCard1;};m.prototype.setSelected=function(n){this.$P2PCreditCard1=n;};m.prototype.getCardType=function(){return this[g.CARD_TYPE];};m.prototype.setCardType=function(n){this[g.CARD_TYPE]=n;this.setCardProviderProps(n,this[g.CARD_NUMBER]);};m.prototype.getCredentialId=function(){return this[g.CREDENTIAL_ID];};m.prototype.setCredentialId=function(n){this[g.CREDENTIAL_ID]=n;};m.prototype.$P2PCreditCard0=function(n,o){var p='default',q,r;if(n){q=Object.keys(h).filter(function(s){return h[s]===n;})[0];p=this.$P2PCreditCard2(q);}else if(o){r=i.getCardType(o);if(r)p=r.name;}return p;};m.prototype.getImage=function(){return this.$P2PCreditCard3||l.unknown.image;};m.prototype.setImage=function(n){this.$P2PCreditCard3=n;};m.prototype.getImageLarge=function(){return this.$P2PCreditCard4||l.unknown.imageLarge;};m.prototype.setImageLarge=function(n){this.$P2PCreditCard4=n;};m.prototype.getName=function(){return this.$P2PCreditCard5||l.unknown.name;};m.prototype.setName=function(n){this.$P2PCreditCard5=n;};m.prototype.getIsPreset=function(){return this.$P2PCreditCard6;};m.prototype.setIsPreset=function(n){this.$P2PCreditCard6=n||false;};m.prototype.$P2PCreditCard2=function(n){switch(n){case 'VISA':n='visa';break;case 'AMERICANEXPRESS':n='amex';break;case 'MASTERCARD':n='mc';break;case 'DISCOVER':n='disc';break;case 'JCB':n='jcb';break;default:n='unknown';break;}return n;};m.prototype.getCreditCardNumberFormatted=function(){return '*'+this[g.CARD_NUMBER];};m.prototype.getCreditCardNumberMask=function(){return '**** **** **** '+this[g.CARD_NUMBER];};m.prototype.getMaxCSCLength=function(){var n=this.$P2PCreditCard0(this[g.CARD_TYPE],this[g.CARD_NUMBER]);return n==='amex'?4:3;};m.prototype.getIsVerified=function(){return this.$P2PCreditCard7||false;};m.prototype.setIsVerified=function(n){this.$P2PCreditCard7=n;};m.prototype.getIsMobileVerified=function(){return this.$P2PCreditCard8||false;};m.prototype.setIsMobileVerified=function(n){this.$P2PCreditCard8=n;};m.prototype.isExpired=function(){var n=this.getExp();if(!n)return false;var o=n,p=o.month,q=o.year,r=new Date(),s=r.getFullYear()+'',t=(r.getMonth()+1)+'';t=t.length===1?'0'+t:t;return q<s||(s===q&&p<t);};e.exports=m;},null);
__d("P2PChooseCreditCardForm.react",["Image.react","P2PCreditCard","P2PEnvironment","React","XUIRadioList.react","XUIGrayText.react","cx","emptyFunction","fbt","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){b.__markCompiled&&b.__markCompiled();'use strict';var q=k.Item,r=j,s=r.PropTypes,t='add_debit_card',u=i.messengerdotcom,v=j.createClass({displayName:"P2PChooseCreditCardForm",propTypes:{creditCards:s.arrayOf(s.instanceOf(h)),selectedCard:s.instanceOf(h).isRequired},getDefaultProps:function(){return {creditCards:[],selectedCard:null,onChange:n,onAddDebitCardOptionSelected:n,showAddDebitCardOption:false};},getInitialState:function(){return {selectedCard:this.props.selectedCard};},getSelectedCard:function(){return this.state.selectedCard;},onChange:function(w){var x;if(w===t){this.props.onAddDebitCardOptionSelected();}else{x=this.props.creditCards.filter(function(y){return y.getCredentialId()===w;})[0];this.setState({selectedCard:x});this.props.onChange(x);}},renderCardItem:function(w,x){return (j.createElement(q,{className:"_2x6n",key:'item-'+x,value:w.getCredentialId()},j.createElement(l,{className:"_3-8r _2jp9",shade:"dark",weight:"bold"},w.getName()),j.createElement(l,{shade:"dark",weight:"normal"},w.getCreditCardNumberFormatted()),j.createElement(g,{className:"_2x6p",height:24,src:w.getImage(),width:36})));},renderAddDebitCardRadioItem:function(){return (j.createElement(q,{className:"_2x6n _1gri",key:'item-'+this.props.creditCards.length,value:t},j.createElement(l,{className:"_3-8r _2jpa",shade:"dark"},o._("Ajouter une carte de d\u00e9bit"))));},getRadioListItems:function(){var w=this.props.creditCards,x=w.map(this.renderCardItem);if(this.props.showAddDebitCardOption)x.push(this.renderAddDebitCardRadioItem());return x;},render:function(){return (j.createElement(k,{selectedValue:this.state.selectedCard.getCredentialId(),className:p(this.props.className,(("_2x6r")+(u?' '+"_2jpb":''))),onValueChange:this.onChange},this.getRadioListItems()));}});e.exports=v;},null);
__d("P2PCreditCardFormFieldMixin.react",["React","ReactInputSelection","XUITextInput.react","cx","emptyFunction"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=49,m=g,n=m.PropTypes,o={propTypes:{onChange:n.func,reference:n.string,saveError:n.string,focused:n.bool,value:n.string,isMasked:n.bool,showFocusOutline:n.bool,showIcon:n.bool,showPlaceholder:n.bool},getDefaultProps:function(){return {onChange:k,saveError:'',focused:false,value:'',isMasked:false,showFocusOutline:true,showIcon:true,showPlaceholder:true};},getInitialState:function(){return {isValid:null,value:'',oldValue:'',focused:false,lastKeyCode:l,modified:false,cursorPosition:0,errorMessage:null};},getInputElement:function(){return this.refs.ccFormFieldInput.refs.textInput.getTextFieldDOM();},restoreCursorPosition:function(){if(!this.getUpdatedCursorPosition)return;if(this.state.oldValue===this.state.value)return;var p=this.getUpdatedCursorPosition(this.state.value,this.state.oldValue,this.state.cursorPosition);h.setSelection(this.getInputElement(),{start:p});},setAndValidate:function(p,q){var r,s=this.state.value,t=h.getSelection(this.getInputElement()),u=this.formatValue?this.formatValue(p,s,q):p;r=this.validate(u);this.setState({modified:true,value:u,oldValue:p,isValid:r,cursorPosition:t.start},this.restoreCursorPosition);this.triggerChange(u,r);},triggerChange:function(p,q){this.props.onChange(this.props.reference,p,q);},componentDidMount:function(){if(this.props.focused)setTimeout(function(){if(this.isMounted())this.focus();}.bind(this),100);this.initializeFormValue();},initializeFormValue:function(){var p;if(this.props.value){p=this.props.isMasked?true:this.validate(this.props.value);this.setState({isValid:p,modified:true,value:this.props.value});this.triggerChange(this.props.value,p);}},handleBlur:function(p){var q=this.getInputElement().value;if(q&&q!==this.state.value)this.setAndValidate(q,l);this.setState({focused:false});},handlePaste:function(p){this.setState({lastKeyCode:l});},handleChange:function(p){this.setAndValidate(p.target.value,this.state.lastKeyCode);},handleOnKeyDown:function(p){var q=p.keyCode;if(q>=96&&q<=105)q=q-48;this.setState({lastKeyCode:q});},handleFocus:function(p){this.setState({focused:true});},focus:function(){g.findDOMNode(this.refs.ccFormFieldInput).focus();},shouldShowIsValidError:function(){if(!this.state.isValid&&this.state.modified)return !this.state.focused||this.isValAtLimit();return false;},isDisabled:function(){return this.props.isMasked;},render:function(){var p=this.shouldShowIsValidError()||this.props.saveError||this.state.errorMessage;return (g.createElement("div",{className:(("_2wac")+(p?' '+"_5bqn":'')+(this.props.showFocusOutline&&!p&&this.state.focused?' '+"_5bqo":'')),onClick:this.focus},this.props.showIcon?this.getIcon():null,g.createElement(i,{autoComplete:this.getAutocompleteName(),ref:"ccFormFieldInput",defaultValue:this.props.defaultValue,value:this.state.value,onChange:this.handleChange,onPaste:this.handlePaste,onKeyDown:this.handleOnKeyDown,onFocus:this.handleFocus,onBlur:this.handleBlur,placeholder:this.props.showPlaceholder?this.getPlaceholder():'',disabled:this.isDisabled(),className:(("_5bqq")+(!this.props.showIcon?' '+"_46tf":'')),xuiError:this.state.errorMessage}),g.createElement("div",{className:"_5br4"})));}};e.exports=o;},null);
__d("P2PCreditCardNumberFormFieldHelper",["Keys"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';var h={formatCardNumber:function(i,j,k,l,m){if(k===g.BACKSPACE||k===g.DELETE){var n=(j.split(m).length-1),o=(i.split(m).length-1);if(o!==n)return i;}i=i.replace(/\D/g,'');i=i.substr(0,l[l.length-1]);var p='';for(var q=1;q<l.length;q++){if(l[q]>i.length||(q===l.length-1)){p+=i.slice(l[q-1]);break;}p+=i.slice(l[q-1],l[q])+m;}return p;},getUpdatedCursorPosition:function(i,j,k,l){var m=0,n=0;while(m<k&&m<j.length&&n<i.length)if(j[m]===i[n]){m++;n++;}else if(!/^\d+$/.test(j[m])){m++;}else n++;if(i.substr(n,1)===l)n++;return n;}};e.exports=h;},null);
__d("P2PCreditCardExpDateFormField.react",["React","P2PCreditCardFormFieldMixin.react","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=g.createClass({displayName:"P2PCreditCardExpDateFormField",mixins:[h],getIcon:function(){return (g.createElement("div",{className:"_31_w _31_x"}));},getAutocompleteName:function(){return 'cc-exp';},isValAtLimit:function(){var l=this.state.value;return l.length===this.getLimit();},getLimit:function(){return 5;},getPlaceholder:function(){return (j._("MM\/AA"));},formatValue:function(l,m,n){var o=this.getLimit(),p=String.fromCharCode(n);l=l.replace(/[^0-9\/]+/g,'');var q=l.split('/'),r=q[0],s=q[1];if(s&&s.length===4){l=r+'/'+s.substr(-2);}else l=l.slice(0,o);if(!/^\d+$/.test(p)&&n!==191&&n!==111)return l;l=l.replace(/\D/g,'');if(/^\d$/.test(l)&&(l!=='0'&&l!=='1')){l='0'+l+'/';}else if(l.length>=2&&l.indexOf('/')===-1)l=l.substr(0,2)+'/'+l.substr(2,4);return l;},validate:function(l){var m=l.split('/'),n=(new Date()),o=parseInt(n.getFullYear().toString().substring(2),10),p=parseInt(n.getMonth()+1,10),q=parseInt(m[0],10),r=parseInt(m[1],10);if(l.length!==5||!q||!r||isNaN(q)||isNaN(r)||q<1||q>12)return false;if((r<o)||(r===o&&q<p)||q>12||q<1)return false;return true;}});e.exports=k;},null);
__d("P2PCreditCardCVCFormField.react",["CreditCardFormParam","React","P2PCreditCardFormFieldMixin.react","PaymentMethodUtils","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=h.createClass({displayName:"P2PCreditCardCVCFormField",mixins:[i],getIcon:function(){return (h.createElement("div",{className:"_31_w _5wcr"}));},getAutocompleteName:function(){return 'cc-csc';},isValAtLimit:function(){var n=this.state.value;return n.length===this.getLimit();},getLimit:function(){var n,o=this.props.cscMaxLength;if(!o){n=j.getCardType(this.props[g.CARD_NUMBER]);o=n.name==='amex'?4:3;}return o;},formatValue:function(n,o,p){var q=this.getLimit();n=n.replace(/\D/g,'');n=n.slice(0,q);return n;},getPlaceholder:function(){return l._("CVV");},validate:function(n){return n.length===this.getLimit();}});e.exports=m;},null);
__d("P2PCreditCardZipCodeFormField.react",["React","P2PCreditCardFormFieldMixin.react","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=g.createClass({displayName:"P2PCreditCardZipCodeFormField",mixins:[h],getIcon:function(){return (g.createElement("div",{className:"_31_w _3oce"}));},getAutocompleteName:function(){return 'postal-code';},isValAtLimit:function(){var l=this.state.value;return l.length===this.getLimit();},getLimit:function(){return 5;},getPlaceholder:function(){return j._("Code postal de facturation");},formatValue:function(l,m,n){var o=this.getLimit();l=l.replace(/\D/g,'');l=l.slice(0,o);return l;},validate:function(l){return l.length===this.getLimit();}});e.exports=k;},null);
__d("P2PErrorNotice.react",["React","XUINotice.react","cx"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j=g,k=j.PropTypes,l=g.createClass({displayName:"P2PErrorNotice",propTypes:{error:k.object},getDefaultProps:function(){return {error:null};},renderErrorContent:function(){var m=this.props.error;if(m.message.__html){return g.createElement("span",{dangerouslySetInnerHTML:m.message});}else return g.createElement("span",null,m.message);},render:function(){return (g.createElement(h,{className:"_3-8n",use:"warn"},this.renderErrorContent()));}});e.exports=l;},null);
__d("P2PCreditCardForm.react",["CreditCardFormParam","KappaWrapper","React","P2PCreditCardNumberFormField.react","P2PCreditCardExpDateFormField.react","P2PCreditCardCVCFormField.react","P2PCreditCardZipCodeFormField.react","P2PErrorDialog.react","P2PErrorNotice.react","ReactLayeredComponentMixin","cx","emptyFunction","fbt","getObjectValues"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){b.__markCompiled&&b.__markCompiled();'use strict';var u=i,v=u.PropTypes,w=i.createClass({displayName:"P2PCreditCardForm",mixins:[p],propTypes:{cscMaxLength:v.number,editMode:v.bool,onErrorDialogOKClick:v.func,onValidation:v.func,prefilledFormData:v.object,rendersErrorDialog:v.bool,saveErrors:v.object},getDefaultProps:function(){return {cscMaxLength:null,editMode:false,onErrorDialogOKClick:r,onValidation:r,prefilledFormData:{},rendersErrorDialog:false,saveErrors:null};},getInitialState:function(){var x={};x[g.CARD_NUMBER]={};x[g.CARD_NUMBER].valid=false;x[g.CARD_NUMBER].value=this.props.prefilledFormData[g.CARD_NUMBER]||'';x[g.CARD_EXPIRATION]={};x[g.CARD_EXPIRATION].valid=false;x[g.CARD_EXPIRATION].value=this.props.prefilledFormData[g.CARD_EXPIRATION]||'';x[g.CSC]={};x[g.CSC].valid=false;x[g.CSC].value=this.props.prefilledFormData[g.CSC]||'';x[g.ZIP]={};x[g.ZIP].valid=false;x[g.ZIP].value=this.props.prefilledFormData[g.ZIP]||'';return {isValid:false,fields:x};},componentWillMount:function(){h.start(6,3,0);},handleFormValueChange:function(x,y,z){var aa=this.state.fields;aa[x]={valid:z,value:y};this.validateForm();},validateForm:function(){var x=true,y=this.state.fields;x=!t(y).some(function(z){return !z.valid;});this.setState({isValid:x});this.props.onValidation(x,this.serializeFormFields());},serializeFormFields:function(){var x=this.state.fields,y={};for(var z in x)if(x.hasOwnProperty(z))y[z]=x[z].value;return y;},getSaveError:function(x){var y='',z=this.props.saveErrors;if(z&&z.fields&&z.fields[x])y=z.fields[x].message;return y;},isCreditCardNumberMasked:function(){return this.props.editMode;},isCreditCardNumberFocused:function(){return !this.props.editMode;},isExpFocused:function(){return this.props.editMode;},renderGeneralError:function(){var x=this.getGeneralError();if(!x)return;return (i.createElement(o,{error:x}));},getGeneralError:function(){if(this.props.saveErrors&&this.props.saveErrors.general)return this.props.saveErrors.general;return null;},handleErrorOKClick:function(){this.props.onErrorDialogOKClick();},renderLayers:function(){var x=this.getGeneralError();if(!this.props.rendersErrorDialog||!x)return {};return {errorMessageDialog:i.createElement(n,{error:x,onOKClick:this.handleErrorOKClick,title:s._("Probl\u00e8me d\u2019enregistrement de la carte")})};},render:function(){return (i.createElement("form",{className:"_3bez"},!this.props.rendersErrorDialog?this.renderGeneralError():null,i.createElement("div",{className:"_2xxs _2xxt"},i.createElement(j,{reference:g.CARD_NUMBER,onChange:this.handleFormValueChange,saveError:this.getSaveError(g.CARD_NUMBER),value:this.state.fields[g.CARD_NUMBER].value,isMasked:this.isCreditCardNumberMasked(),focused:this.isCreditCardNumberFocused()})),i.createElement("div",{className:"_2xxs _2xxu"},i.createElement(k,{reference:g.CARD_EXPIRATION,focused:this.isExpFocused(),onChange:this.handleFormValueChange,saveError:this.getSaveError(g.CARD_EXPIRATION),value:this.state.fields[g.CARD_EXPIRATION].value}),i.createElement(l,{reference:g.CSC,onChange:this.handleFormValueChange,saveError:this.getSaveError(g.CSC),cscMaxLength:this.props.cscMaxLength,creditCardNumber:this.state.fields[g.CARD_NUMBER].value,value:this.state.fields[g.CSC].value})),i.createElement("div",{className:"_2xxs _2xxv"},i.createElement(m,{reference:g.ZIP,onChange:this.handleFormValueChange,saveError:this.getSaveError(g.ZIP),value:this.state.fields[g.ZIP].value}))));}});e.exports=w;},null);
__d("P2PEditCreditCardDialog.react",["CreditCardFormParam","React","P2PAPI","P2PAPIUtils","P2PCreditCard","P2PCreditCardForm.react","P2PLoadingMask.react","P2PDialog.react","P2PDialogTitle.react","P2PDialogBody.react","P2PDialogFooter.react","P2PEnvironment","P2PButton.react","P2PText.react","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){b.__markCompiled&&b.__markCompiled();'use strict';var w=h,x=w.PropTypes,y=h.createClass({displayName:"P2PEditCreditCardDialog",propTypes:{asyncRequestState:x.object.isRequired,creditCard:x.instanceOf(k).isRequired,onCancel:x.func.isRequired,onSuccess:x.func.isRequired},getInitialState:function(){return {isValid:false,formData:{},loading:false,requestID:'',saveErrors:null};},componentWillReceiveProps:function(z){var aa=z.asyncRequestState?z.asyncRequestState[this.state.requestID]:null;if(aa){this.setState({requestID:''});if(aa.error){this.handleOnSaveError(aa.error);}else this.handleOnSaveSuccess(aa);}},clearSaveErrors:function(){this.setState({saveErrors:null});},onSaveClick:function(z){var aa={},ba=j.genRequestID();aa[g.CREDENTIAL_ID]=this.props.creditCard.getCredentialId();this.clearSaveErrors();this.setState({loading:true,requestID:ba});i.updateCreditCard(Object.assign({requestID:ba},aa,this.state.formData));},handleOnSaveSuccess:function(z){this.props.onSuccess(z);},onCancelClick:function(z){this.props.onCancel();},handleOnSaveError:function(z){this.setState({loading:false,saveErrors:z});},isSaveDisabled:function(){return !this.state.isValid||this.state.loading;},isCancelDisabled:function(){return this.state.loading;},handleValidation:function(z,aa){this.setState({isValid:z,formData:aa});},getPrefilledFormData:function(){var z={};z[g.CARD_NUMBER]=this.props.creditCard.getCreditCardNumberMask();z[g.CARD_EXPIRATION]=this.props.creditCard.getExpFormattedShort();z[g.ZIP]=this.props.creditCard.getZipCode();return z;},handleErrorDialogOKClick:function(){this.clearSaveErrors();},onToggle:function(z){if(!z)this.props.onCancel();},render:function(){var z=r.messengerdotcom,aa=z?350:300;return (h.createElement(n,{layerHideOnBlur:false,onToggle:this.onToggle,repositionOnUpdate:true,shown:true,width:aa},h.createElement(o,null,v._("Mettre \u00e0 jour la carte de d\u00e9bit")),h.createElement(p,null,h.createElement(t,{className:"_3-96",type:"primary"},v._("Veuillez mettre \u00e0 jour la date d\u2019expiration de votre carte se terminant par {card numbers}.",[v.param("card numbers",this.props.creditCard.getCreditCardNumber())])),h.createElement(l,{onValidation:this.handleValidation,saveErrors:this.state.saveErrors,editMode:true,prefilledFormData:this.getPrefilledFormData(),cscMaxLength:this.props.creditCard.getMaxCSCLength()})),h.createElement(q,null,h.createElement(s,{use:"default",size:"medium",label:v._("Annuler"),disabled:this.isCancelDisabled(),onClick:this.onCancelClick}),h.createElement(s,{use:"confirm",size:"medium",label:v._("Enregistrer"),disabled:this.isSaveDisabled(),onClick:this.onSaveClick})),h.createElement(m,{visible:this.state.loading})));}});e.exports=y;},null);
__d("P2PLogger",["BanzaiLogger"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';var h='P2PPaymentLoggerConfig',i={log:function(j,k){k=Object.assign({event:j},k);g.log(h,k);}};e.exports=i;},null);
__d("P2PPasswordProtectionNUXDialog.react",["Link.react","P2PAPI","P2PEnvironment","P2PErrorDialog.react","P2PLinkConstants","P2PLoadingMask.react","P2PLogger","P2PPaymentLoggerEvent","P2PPaymentLoggerEventFlow","P2PPasswordProtectionParam","P2PPasswordProtectionStatusTypes","React","P2PButton.react","P2PDialog.react","P2PDialogTitle.react","P2PDialogBody.react","P2PDialogFooter.react","P2PText.react","cx","emptyFunction","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa){b.__markCompiled&&b.__markCompiled();'use strict';var ba=r,ca=ba.PropTypes,da=i.messengerdotcom,ea=r.createClass({displayName:"P2PPasswordProtectionNUXDialog",propTypes:{onComplete:ca.func},getDefaultProps:function(){return {onComplete:z};},getInitialState:function(){return {saveErrorObject:null,loading:false};},componentWillMount:function(){this.log(n.UI_ACTN_INITIATE_PASSWORD_PROTECTION_NUX);},log:function(fa,ga){m.log(fa,Object.assign({www_event_flow:o.UI_FLOW_P2P_SETTINGS},ga));},onSaveClick:function(){this.setState({loading:true,saveErrorObject:null});this.setPasswordProtection(q.ENABLED);this.log(n.UI_ACTN_OPT_IN_PASSWORD_PROTECTION_NUX);},setPasswordProtection:function(fa){var ga={};ga[p.STATUS]=fa;h.setPasswordProtectionSetting({formData:ga,success:this.handleOnSaveSuccess,error:this.handleOnSaveError});},handleOnSaveSuccess:function(){this.setState({loading:false});this.props.onComplete();},handleOnSaveError:function(fa){this.setState({loading:false,saveErrorObject:fa});},isSaveButtonDisabled:function(){return this.state.loading;},isCancelButtonDisabled:function(){return this.state.loading;},onCancelClick:function(){this.setState({loading:true,saveErrorObject:null});this.setPasswordProtection(q.DISABLED);this.log(n.UI_ACTN_OPT_OUT_PASSWORD_PROTECTION_NUX);},handleErrorBackClick:function(){this.setState({saveErrorObject:null});},handleErrorOKClick:function(){this.setState({saveErrorObject:null});this.props.onComplete();},render:function(){var fa=da?320:300;if(this.state.saveErrorObject)return (r.createElement(j,{allowBack:true,title:aa._("Probl\u00e8me d\u2019enregistrement"),onBackClick:this.handleErrorBackClick,onOKClick:this.handleErrorOKClick,error:this.state.saveErrorObject}));return (r.createElement(t,{className:((da?"_-el":'')),behaviors:{LayerFadeOnShow:false},layerHideOnBlur:false,shown:true,width:fa},r.createElement(u,{showCloseButton:false},aa._("Utiliser un mot de passe\u00a0?")),r.createElement(v,null,r.createElement(x,{className:"_5sor",type:"primary"},aa._("Pour plus de s\u00e9curit\u00e9, vous pouvez saisir votre mot de passe Facebook pour envoyer de l\u2019argent. Vous pouvez toujours le mettre \u00e0 jour dans {link}.",[aa.param("link",r.createElement(g,{href:k.settingsWWWURI,target:"_blank"},aa._("Param\u00e8tres")))]))),r.createElement(w,null,r.createElement(s,{className:"_5sov",disabled:this.isCancelButtonDisabled(),label:aa._("Plus tard"),onClick:this.onCancelClick,size:"medium",use:"default"}),r.createElement(s,{className:"_5sox",disabled:this.isSaveButtonDisabled(),label:aa._("Utiliser un mot de passe"),onClick:this.onSaveClick,size:"medium",use:"confirm"})),r.createElement(l,{visible:this.state.loading})));}});e.exports=ea;},null);
__d("LayerSlowlyFadeOnShow",["LayerFadeOnShow"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h=500,i=g.forDuration(h);e.exports=i;},null);
__d("P2PSuccessDialog.react",["Image.react","LayerFadeOnHide","LayerSlowlyFadeOnShow","LeftRight.react","P2PEnvironment","React","P2PButton.react","P2PDialog.react","P2PDialogTitle.react","P2PDialogBody.react","P2PDialogFooter.react","P2PText.react","ix","cx","fbt","emptyFunction"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){b.__markCompiled&&b.__markCompiled();'use strict';var w=l,x=w.PropTypes,y=l.createClass({displayName:"P2PSuccessDialog",propTypes:{onOKClick:x.func,title:x.string.isRequired},getDefaultProps:function(){return {onOKClick:v};},render:function(){var z=k.messengerdotcom,aa=z?350:300,ba=z?s("/images/p2p/checkmark-messenger.png"):s("/images/p2p/check_mark-sm.png"),ca=[l.createElement("div",{className:"_1tcj",key:"checkmark"},l.createElement(g,{height:50,width:50,src:ba})),l.createElement(r,{className:"_3exn",key:"confirmation_text",type:"primary"},this.props.children)];if(z)ca=l.createElement(j,{direction:"left"},ca);return (l.createElement(n,{behaviors:{LayerFadeOnShow:false,LayerSlowlyFadeOnShow:i,LayerFadeOnHide:h},className:(("_1tck")+(z?' '+"_1tcl":'')),layerHideOnBlur:false,ref:"dialog",repositionOnUpdate:true,shown:true,width:aa},l.createElement("div",{className:"_1tcm"},l.createElement(o,{className:"_1tcn",showCloseButton:false},this.props.title),l.createElement(p,null,ca),l.createElement(q,null,l.createElement(m,{use:"default",label:u._("OK"),onClick:this.props.onOKClick})))));}});e.exports=y;},null);
__d("P2PVerifyCreditCardDialog.react",["CreditCardFormParam","P2PAPI","P2PAPIUtils","P2PCreditCard","P2PEnvironment","P2PErrorNotice.react","P2PLoadingMask.react","React","P2PButton.react","P2PDialog.react","P2PDialogBody.react","P2PDialogFooter.react","P2PCreditCardCVCFormField.react","P2PCreditCardZipCodeFormField.react","XUICloseButton.react","P2PDialogTitle.react","P2PText.react","cx","emptyFunction","fbt","getObjectValues"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa){b.__markCompiled&&b.__markCompiled();var ba=n,ca=ba.PropTypes,da=k.messengerdotcom,ea=n.createClass({displayName:"P2PVerifyCreditCardDialog",propTypes:{asyncRequestState:ca.object,creditCard:ca.instanceOf(j),onCancel:ca.func,onConfirm:ca.func,isSending:ca.bool},getDefaultProps:function(){return {asyncRequestState:{},creditCard:null,isSending:true,onCancel:y,onError:y,onSuccess:y};},getInitialState:function(){var fa={};fa[g.CSC]={};fa[g.CSC].valid=false;if(this.shouldShowZIPInput()){fa[g.ZIP]={};fa[g.ZIP].valid=false;}return {isValid:false,loading:false,requestID:'',saveError:null,fields:fa};},componentWillReceiveProps:function(fa){var ga=fa.asyncRequestState?fa.asyncRequestState[this.state.requestID]:null;if(ga){this.setState({requestID:''});if(ga.error){this.handleOnSaveError(ga.error);}else this.handleOnSaveSuccess(ga);}},handleOnSaveSuccess:function(fa){this.props.onSuccess(fa);},handleOnSaveError:function(fa){this.setState({loading:false,saveError:fa});},clearSaveError:function(){this.setState({saveError:null});},handleCancelClick:function(){this.props.onCancel();},handleConfirmClick:function(){var fa={},ga=i.genRequestID();fa[g.CREDENTIAL_ID]=this.props.creditCard.getCredentialId();fa[g.CSC]=this.state.fields[g.CSC].value;if(this.state.fields[g.ZIP])fa[g.ZIP]=this.state.fields[g.ZIP].value;this.clearSaveError();this.setState({loading:true,requestID:ga});h.verifyCreditCard(Object.assign({requestID:ga},fa));},handleFormValueChange:function(fa,ga,ha){var ia=this.state.fields;ia[fa].value=ga;ia[fa].valid=ha;this.setState({fields:ia});this.validateForm();},validateForm:function(){var fa=true,ga=this.state.fields;fa=!aa(ga).some(function(ha){return !ha.valid;});this.setState({isValid:fa});},handleCloseButtonClick:function(){this.props.onCancel();},shouldShowZIPInput:function(){var fa=!!(this.props.creditCard.getZipCode());return !fa;},renderError:function(){var fa;if(this.state.saveError)fa=n.createElement(l,{error:this.state.saveError});return fa;},renderCVCFormField:function(){return (n.createElement(s,{cscMaxLength:this.props.creditCard.getMaxCSCLength(),focused:true,onChange:this.handleFormValueChange,reference:'csc',showIcon:false,showPlaceholder:false,showFocusOutline:false}));},renderZIPFormField:function(){return (n.createElement(t,{onChange:this.handleFormValueChange,reference:'zip',showIcon:false,showPlaceholder:false,showFocusOutline:false}));},getMessage:function(){var fa=this.props.creditCard.getName(),ga=this.props.creditCard.getCreditCardNumber();if(this.props.isSending){if(this.shouldShowZIPInput()){return (n.createElement(w,{type:"primary"},z._("Entrez le code de s\u00e9curit\u00e9 au verso de votre carte {credit card issuer} se terminant par {credit card number last 4 digits} et le code postal de facturation pour envoyer ce paiement.",[z.param("credit card issuer",fa),z.param("credit card number last 4 digits",ga)])));}else return (n.createElement(w,{type:"primary"},z._("Entrez le code de s\u00e9curit\u00e9 au verso de votre carte {credit card issuer} se terminant par {credit card number last 4 digits} pour envoyer ce paiement.",[z.param("credit card issuer",fa),z.param("credit card number last 4 digits",ga)])));}else if(this.shouldShowZIPInput()){return (n.createElement(w,{type:"primary"},z._("Entrez le code de s\u00e9curit\u00e9 au verso de votre carte {credit card issuer} se terminant par {credit card number last 4 digits} et le code postal de facturation pour accepter ce paiement.",[z.param("credit card issuer",fa),z.param("credit card number last 4 digits",ga)])));}else return (n.createElement(w,{type:"primary"},z._("Entrez le cryptogramme au dos  de votre {credit card issuer} se terminant par {credit card number last 4 digits} pour accepter ce paiement.",[z.param("credit card issuer",fa),z.param("credit card number last 4 digits",ga)])));},getInputs:function(){var fa,ga=n.createElement("div",{className:"_3yfa"},n.createElement(w,{className:"_197h",type:"primary"},z._("Code de s\u00e9curit\u00e9")),n.createElement("div",{className:"_197i"},this.renderCVCFormField()));if(this.shouldShowZIPInput())fa=n.createElement("div",{className:"_3yfb"},n.createElement(w,{className:"_197h",type:"primary"},z._("Code postal de facturation")),n.createElement("div",{className:"_197i"},this.renderZIPFormField()));return (n.createElement("div",null,ga,fa));},render:function(){var fa,ga,ha;if(da){ha=320;fa=n.createElement(o,{use:"default",size:"medium",label:z._("Annuler"),disabled:this.state.loading,onClick:this.props.onCancel});}else{ha=300;ga=n.createElement(u,{onClick:this.handleCloseButtonClick});}return (n.createElement(p,{className:((da?"_4ypw":'')),layerHideOnBlur:false,ref:"dialog",repositionOnUpdate:true,shown:true,width:ha},n.createElement(v,{showCloseButton:false},z._("Entrer le code de s\u00e9curit\u00e9"),ga),n.createElement(q,null,n.createElement("div",{className:"_197f"},this.getMessage()),this.renderError(),n.createElement("div",{className:"_197g"},this.getInputs())),n.createElement(r,null,fa,n.createElement(o,{label:z._("Confirmer"),onClick:this.handleConfirmClick,disabled:!this.state.isValid||this.state.loading,use:"confirm"})),n.createElement(m,{visible:this.state.loading})));}});e.exports=ea;},null);
__d("P2PAcceptMoneyDialog.react",["CreditCardFormParam","Link.react","P2PCreditCardForm.react","P2PAPI","P2PAPIUtils","P2PChooseCreditCardForm.react","P2PCreditCard","P2PErrorDialog.react","P2PErrorNotice.react","P2PLinkConstants","P2PLoadingMask.react","P2PLogger","P2PPasswordProtectionNUXDialog.react","P2PPasswordProtectionStatusTypes","P2PPaymentLoggerEvent","P2PPaymentLoggerEventFlow","P2PSuccessDialog.react","P2PTransferParam","P2PVerifyCreditCardDialog.react","React","P2PButton.react","P2PDialog.react","P2PEditCreditCardDialog.react","XUICloseButton.react","P2PDialogTitle.react","P2PDialogBody.react","P2PDialogFooter.react","P2PEnvironment","P2PText.react","cx","emptyFunction","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la){b.__markCompiled&&b.__markCompiled();'use strict';var ma=z,na=ma.PropTypes,oa='fbP2PAcceptMoneyDialog_learnMoreSentenceID',pa=ha.messengerdotcom,qa=z.createClass({displayName:"P2PAcceptMoneyDialog",propTypes:{asyncRequestState:na.object,creditCards:na.arrayOf(na.instanceOf(m)).isRequired,onClose:na.func,transfer:na.object},getDefaultProps:function(){return {asyncRequestState:{},onClose:ka,creditCards:[]};},getInitialState:function(){return {addCreditCardRequestID:'',isValid:false,declineErrorObject:null,editCreditCardDialogShown:false,formData:{},loading:false,passwordNUXPending:false,passwordProtectionNUXDialogShown:false,presetRequestID:'',presetSaveErrorObject:null,saveErrors:null,selectedCard:this.props.creditCards[0],showConfirmation:false,showDeclineConfirmation:false,showChooseCreditCardForm:this.props.creditCards.length>0,verifyCreditCardDialogShown:false};},log:function(ra,sa){r.log(ra,Object.assign({www_event_flow:v.UI_FLOW_P2P_RECEIVE,object_id:this.props.transfer[x.TRANSFER_ID]},sa));},componentWillMount:function(){this.log(u.UI_ACTN_INITIATE_ADD_CARD);},componentWillReceiveProps:function(ra){var sa=ra.asyncRequestState,ta=sa?sa[this.state.addCreditCardRequestID]:null,ua=sa?sa[this.state.presetRequestID]:null;if(ta){this.setState({addCreditCardRequestID:''});if(ta.error){this.handleAcceptAddCardError(ta.error);}else this.handleAcceptAddCardSuccess(ta);}else if(ua){this.setState({presetRequestID:''});if(ua.error){this.handleUpdatePresetCreditCardError(ua.error);}else this.handleUpdatePresetCreditCardSuccess(ua);}},onBlur:function(){this.props.onClose();},handleAddCardBackButtonClick:function(){this.setState({isValid:false,formData:{},presetSaveErrorObject:null,saveErrors:null,showChooseCreditCardForm:true});},handleAcceptWithCardButtonClick:function(){this.initiateAcceptWithSelectedCard();},initiateAcceptWithSelectedCard:function(){if(this.state.selectedCard.isExpired()){this.setState({editCreditCardDialogShown:true,verifyCreditCardDialogShown:false});this.log(u.UI_ACTN_EDIT_CARD);return;}else if(!this.state.selectedCard.getIsVerified()){this.setState({verifyCreditCardDialogShown:true,editCreditCardDialogShown:false});this.log(u.UI_ACTN_VERIFY_CSC);return;}this.acceptWithSelectedCard();},acceptWithSelectedCard:function(){this.setState({presetSaveErrorObject:null,loading:true});this.log(u.UI_ACTN_ACCEPT_WITH_CARD);this.updatePresetCreditCard(this.state.selectedCard.getCredentialId());},onVerifyCreditCardSuccess:function(){this.initiateAcceptWithSelectedCard();},onVerifyCreditCardCancel:function(){this.setState({verifyCreditCardDialogShown:false});},onEditCreditCardSuccess:function(){this.initiateAcceptWithSelectedCard();},onEditCreditCardCancel:function(){this.setState({editCreditCardDialogShown:false});},handleAddDebitCardOptionClicked:function(){this.setState({presetSaveErrorObject:null,showChooseCreditCardForm:false});},handleDeclineCardBackButtonClick:function(){this.setState({isValid:false,formData:{},presetSaveErrorObject:null,saveErrors:null,showDeclineConfirmation:false});},handleDeclineCardSubmitButtonClick:function(){var ra={};this.setState({loading:true,declineErrorObject:null});ra[x.TRANSFER_ID]=this.props.transfer[x.TRANSFER_ID];j.declineTransaction({formData:ra,success:this.handleDeclineSuccess,error:this.handleDeclineError});},handleDeclineSuccess:function(){this.props.onClose();},handleDeclineError:function(ra){this.setState({loading:false,declineErrorObject:ra});},handleNoDebitCardClick:function(){if(!this.state.loading)this.setState({showDeclineConfirmation:true});},handleAcceptAddCardClick:function(){var ra=k.genRequestID();this.setState({addCreditCardRequestID:ra,loading:true,presetSaveErrorObject:null,saveErrors:null});this.log(u.UI_ACTN_CONFIRM_CARD_DETAILS);j.addCreditCard(Object.assign({requestID:ra},this.state.formData));},handleAcceptAddCardSuccess:function(ra){this.updatePresetCreditCard(ra[g.CREDENTIAL_ID]);this.log(u.UI_ACTN_ADD_CARD_SUCCESS);},handleAcceptAddCardError:function(ra){this.setState({loading:false,saveErrors:ra});this.log(u.UI_ACTN_ADD_CARD_FAIL,{message:ra&&ra.general?ra.general.message:''});},updatePresetCreditCard:function(ra){var sa={},ta=k.genRequestID();sa[g.CREDENTIAL_ID]=ra;this.setState({presetRequestID:ta});j.updatePresetCreditCard(Object.assign({},sa,{requestID:ta}));},handleUpdatePresetCreditCardSuccess:function(ra){this.setState({loading:false,editCreditCardDialogShown:false,verifyCreditCardDialogShown:false,showConfirmation:true,passwordNUXPending:ra.passwordProtection===t.NOT_SET});},handleUpdatePresetCreditCardError:function(ra){this.setState({loading:false,presetSaveErrorObject:ra});},handleValidation:function(ra,sa){this.setState({isValid:ra,formData:sa});},handleConfirmationOKClick:function(){if(this.state.passwordNUXPending){this.setState({passwordNUXPending:false,passwordProtectionNUXDialogShown:true});}else this.props.onClose();},handleCloseButtonClick:function(){this.props.onClose();this.log(u.UI_ACTN_CANCEL_ADD_CARD);},handleErrorBackClick:function(){this.setState({declineErrorObject:null});},handleErrorOKClick:function(){this.setState({declineErrorObject:null});this.props.onClose();},handlePasswordProtectionNUXComplete:function(){this.setState({passwordProtectionNUXDialogShown:false});this.props.onClose();},handleCreditCardSelected:function(ra){this.setState({selectedCard:ra});},renderChooseCreditCardForm:function(){var ra,sa;if(!pa){ra=z.createElement(da,{onClick:this.handleCloseButtonClick});}else sa=z.createElement(aa,{use:"default",size:"medium",label:la._("Annuler"),disabled:this.state.loading,onClick:this.onBlur});return (z.createElement("div",{className:"_2_t"},z.createElement(ea,{showCloseButton:false},la._("Ajouter une carte de d\u00e9bit"),ra),z.createElement(fa,{className:"_2_u"},z.createElement(ia,{type:"primary",className:"_2_w"},la._("Reliez une carte de d\u00e9bit pour envoyer et recevoir de l\u2019argent.")),this.renderPresetError(),z.createElement(l,{className:((!pa?"_2pij":'')),creditCards:this.props.creditCards,onAddDebitCardOptionSelected:this.handleAddDebitCardOptionClicked,onChange:this.handleCreditCardSelected,ref:"choose_credit_card_form",selectedCard:this.state.selectedCard,showAddDebitCardOption:true})),z.createElement(ga,null,sa,z.createElement(aa,{disabled:this.state.loading,label:la._("Accepter"),onClick:this.handleAcceptWithCardButtonClick,size:"medium",use:"confirm"}))));},renderPresetError:function(){var ra;if(this.state.presetSaveErrorObject)ra=z.createElement(o,{error:this.state.presetSaveErrorObject});return ra;},renderAcceptMoney:function(){var ra=this.props.transfer,sa,ta=z.createElement(aa,{disabled:this.state.loading||!this.state.isValid,label:la._("Accepter"),onClick:this.handleAcceptAddCardClick,size:"medium",use:"confirm"}),ua,va;if(!pa){va=z.createElement(da,{onClick:this.handleCloseButtonClick});}else ua=z.createElement(aa,{use:"default",size:"medium",label:la._("Annuler"),disabled:this.state.loading,onClick:this.onBlur});if(this.props.creditCards.length===0){sa=z.createElement(ga,{leftContent:z.createElement(ia,{type:"secondary"},z.createElement(h,{href:"#",onClick:this.handleNoDebitCardClick},la._("Refuser le paiement")))},ua,ta);}else sa=z.createElement(ga,null,z.createElement(aa,{disabled:this.state.loading,label:la._("Pr\u00e9c."),onClick:this.handleAddCardBackButtonClick,size:"medium",use:"default"}),ta);return (z.createElement("div",{className:"_1p_r"},z.createElement(ea,{showCloseButton:false},la._("Ajouter une carte de d\u00e9bit"),va),z.createElement(fa,null,z.createElement(ia,{type:"primary",className:"_3-96"},la._("{sender_name} vous a envoy\u00e9 {amount} {currency}. Ajoutez une carte de d\u00e9bit pour l\u2019accepter.",[la.param("sender_name",ra.sender.name),la.param("currency",ra.currency),la.param("amount",ra.amount)])),z.createElement("div",{className:"_1p_w"},this.renderPresetError(),z.createElement(i,{onValidation:this.handleValidation,saveErrors:this.state.saveErrors})),z.createElement(ia,{id:oa,type:"secondary"},la._("Vos informations de paiement sont stock\u00e9es de mani\u00e8re s\u00e9curis\u00e9e. {Link to P2P learn more page.}",[la.param("Link to P2P learn more page.",z.createElement(h,{"aria-describedby":oa,href:p.addDebitCardHelpURI,target:"_blank"},la._("En savoir plus.")))]))),sa));},renderDeclineConfirmation:function(){var ra=this.props.transfer,sa;if(!pa)sa=z.createElement(da,{onClick:this.handleCloseButtonClick});return (z.createElement("div",{className:"_301"},z.createElement(ea,{showCloseButton:false},la._("Refuser le paiement\u00a0?"),sa),z.createElement(fa,null,z.createElement(ia,{type:"primary"},la._("Le refus de ce paiement renverra l\u2019argent \u00e0 {friendName}.",[la.param("friendName",ra.sender.name)]))),z.createElement(ga,null,z.createElement(aa,{disabled:this.state.loading,label:la._("Retour"),onClick:this.handleDeclineCardBackButtonClick,size:"medium",use:"default"}),z.createElement(aa,{disabled:this.state.loading,label:la._("D\u00e9cliner"),onClick:this.handleDeclineCardSubmitButtonClick,size:"medium",use:"default"}))));},render:function(){var ra,sa=pa?350:300;if(this.state.verifyCreditCardDialogShown){return (z.createElement(y,{creditCard:this.state.selectedCard,asyncRequestState:this.props.asyncRequestState,isSending:false,onCancel:this.onVerifyCreditCardCancel,onSuccess:this.onVerifyCreditCardSuccess}));}else if(this.state.editCreditCardDialogShown){return (z.createElement(ca,{asyncRequestState:this.props.asyncRequestState,creditCard:this.state.selectedCard,onCancel:this.onEditCreditCardCancel,onSuccess:this.onEditCreditCardSuccess}));}else if(this.state.declineErrorObject){return (z.createElement(n,{ref:"decline_error",allowBack:true,onBackClick:this.handleErrorBackClick,onOKClick:this.handleErrorOKClick,error:this.state.declineErrorObject,title:la._("Probl\u00e8me pour refuser")}));}else if(this.state.passwordProtectionNUXDialogShown){return (z.createElement(s,{onComplete:this.handlePasswordProtectionNUXComplete}));}else if(this.state.showConfirmation)return (z.createElement(w,{onOKClick:this.handleConfirmationOKClick,title:la._("Paiement re\u00e7u")},z.createElement(ia,{type:"primary"},la._("L\u2019argent que vous recevrez ira d\u00e9sormais automatiquement sur cette carte. Vous pouvez mettre votre carte \u00e0 jour dans {Link with text that goes to settings page}.",[la.param("Link with text that goes to settings page",z.createElement(h,{target:"_blank",href:p.settingsWWWURI},la._("Param\u00e8tres de paiement")))]))));if(this.state.showDeclineConfirmation){ra=this.renderDeclineConfirmation();}else if(this.state.showChooseCreditCardForm){ra=this.renderChooseCreditCardForm();}else ra=this.renderAcceptMoney();return (z.createElement(ba,{className:(("_309")+(pa?' '+"_5ktw":'')),layerHideOnBlur:false,ref:"dialog",repositionOnUpdate:true,shown:true,width:sa},ra,z.createElement(q,{ref:"send_money_dialog_loader",visible:this.state.loading})));}});e.exports=qa;},null);
__d("P2PVerificationFlowHelper",["AsyncDialog","AsyncRequest","P2PAPI","P2PTransferParam","emptyFunction"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=null,m=null,n=null,o={startVerificationFlow:function(p,q,r){l=p;m=q;n=r||k;g.send(new h('/p2p/verify/dialog/?id='+p));},setupFlowExitHandler:function(p,q,r,s){var t=function(w){n(w);l=null;m=null;n=null;p.destroy();q.destroy();};if(r){p.subscribe('hide',function(){t(s);});}else{var u=false,v=false;p.subscribe('confirm',function(){u=true;});p.subscribe('hide',function(){if(u){p.destroy();q.destroy();}else if(m){q.show();}else t(false);});q.subscribe('confirm',function(){v=true;var w={};w[j.TRANSFER_ID]=l;i.cancelTransaction({formData:w});t(false);});q.subscribe('hide',function(){if(!v)p.show();});}}};e.exports=o;},null);
__d("P2PCreditCardStore",["P2PActionConstants","CreditCardFormParam","EventEmitter","ImmutableObject","P2PAPI","P2PCreditCard","P2PDispatcher"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();'use strict';var n,o,p,q,r;function s(x,y){if(x)r[x]=new j(y);}function t(x,y){if(x)r[x]={error:y};}for(var u in i)if(i.hasOwnProperty(u))w[u]=i[u];var v=i===null?null:i.prototype;w.prototype=Object.create(v);w.prototype.constructor=w;w.__superConstructor__=i;function w(){i.call(this);p=false;q=false;n=[];r={};o=m.register(this.onEventDispatched.bind(this));}w.prototype.onEventDispatched=function(x){var y=x.data,z=x.type;switch(z){case g.CREDIT_CARDS_UPDATED:this.handleCreditCardsUpdated(y);this.emit('change');break;case g.CREDIT_CARD_ADDED:this.handleCreditCardAdded(y);this.emit('change');break;case g.CREDIT_CARD_ADDED_ERROR:this.handleCreditCardAddedError(y);this.emit('change');break;case g.CREDIT_CARD_DELETED:this.handleCreditCardDeleted(y);this.emit('change');break;case g.CREDIT_CARD_DELETED_ERROR:this.handleCreditCardDeletedError(y);this.emit('change');break;case g.CREDIT_CARD_UPDATED:this.handleCreditCardUpdated(y);this.emit('change');break;case g.CREDIT_CARD_UPDATED_ERROR:this.handleCreditCardUpdatedError(y);this.emit('change');break;case g.PRESET_CREDIT_CARD_UPDATED:this.handlePresetCreditCardUpdated(y);this.emit('change');break;case g.PRESET_CREDIT_CARD_UPDATED_ERROR:this.handlePresetCreditCardUpdatedError(y);this.emit('change');break;case g.CREDIT_CARD_VERIFIED:this.handleCreditCardVerified(y);this.emit('change');break;case g.CREDIT_CARD_VERIFIED_ERROR:this.handleCreditCardVerifiedError(y);this.emit('change');break;}};w.prototype.getAsyncRequestState=function(){return r;};w.prototype.isCreditCardsFetchComplete=function(){return p;};w.prototype.handleCreditCardsUpdated=function(x){p=true;n=x.map(function(y){return new l(y);});};w.prototype.handleCreditCardAdded=function(x){var y=false;s(x.requestID,x);n.forEach(function(z){if(z.getCredentialId()===x[h.CREDENTIAL_ID])y=true;});if(y)return;n.push(new l(x));};w.prototype.handleCreditCardAddedError=function(x){t(x.requestID,x.errors);};w.prototype.handleCreditCardDeleted=function(x){var y=x[h.CARD_FBID];s(x.requestID,x);n=n.filter(function(z){return z.getCredentialId()!==y;});};w.prototype.handleCreditCardDeletedError=function(x){t(x.requestID,x.error);};w.prototype.handleCreditCardUpdated=function(x){s(x.requestID,x);n.forEach(function(y,z){if(y.getCredentialId()===x[h.CREDENTIAL_ID]){y.setExp(x[h.CARD_EXPIRATION]);y.setZipCode(x[h.ZIP]);}});};w.prototype.handleCreditCardUpdatedError=function(x){t(x.requestID,x.errors);};w.prototype.handlePresetCreditCardUpdated=function(x){var y=x[h.CARD_FBID];s(x.requestID,x);var z=n.filter(function(ba){return ba.getIsPreset();})[0];if(z)z.setIsPreset(false);var aa=n.filter(function(ba){return ba.getCredentialId()===y;})[0];if(aa)aa.setIsPreset(true);};w.prototype.handlePresetCreditCardUpdatedError=function(x){t(x.requestID,x.error);};w.prototype.handleCreditCardVerified=function(x){s(x.requestID,x);n.forEach(function(y,z){if(y.getCredentialId()===x[h.CREDENTIAL_ID])y.setIsVerified(true);});};w.prototype.handleCreditCardVerifiedError=function(x){t(x.requestID,x.error);};w.prototype.getAll=function(){if(!q){q=true;k.getAllCreditCards();}return n;};w.prototype.getAllSettingsEligible=function(){var x=this.getAll();return x.filter(function(y){return y.getIsVerified()||y.getIsMobileVerified();});};w.prototype.getPresetCard=function(){var x=this.getAll();return x.filter(function(y){return y.getIsPreset();})[0];};e.exports=new w();},null);
__d("P2PTransferStore",["Arbiter","P2PActionConstants","ChannelConstants","CreditCardFormParam","EventEmitter","ImmutableObject","P2PActions","P2PAPI","P2PChannelType","P2PCreditCard","P2PDispatcher","P2PNUXRendererUtils","P2PTransferParam","P2PTransferStatus","MercuryThreadInformer"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){b.__markCompiled&&b.__markCompiled();'use strict';var u=b('MercuryThreadInformer').get(),v,w,x,y,z,aa,ba,ca,da,ea=null,fa=false;function ga(la,ma){if(la)da[la]=new l(ma);}function ha(la,ma){if(la)da[la]={error:ma};}for(var ia in k)if(k.hasOwnProperty(ia))ka[ia]=k[ia];var ja=k===null?null:k.prototype;ka.prototype=Object.create(ja);ka.prototype.constructor=ka;ka.__superConstructor__=k;function ka(){k.call(this);v=false;x=[];da={};z=g.subscribe(i.getArbiterType(o.TRANSFER_STATUS_CHANGED),this.handleChannelTransferStatusChanged.bind(this));aa=u.subscribe('messages-received',this.handleMessageReceived.bind(this));ba=u.subscribe('messages-updated',this.handleMessageUpdated.bind(this));y=q.register(this.onEventDispatched.bind(this));}ka.prototype.onEventDispatched=function(la){var ma=la.data,na=la.type;switch(na){case h.TRANSFERS_UPDATED:this.handleTransfersUpdated(ma);this.emit('change');break;case h.TRANSFERS_UPDATED_ERROR:this.handleTransfersUpdatedError(ma);this.emit('change');break;case h.NUX_TRANSFERS_UPDATED:this.handleNUXTransfersUpdated(ma);this.emit('change');break;case h.TRANSFER_ADDED:this.handleTransferAdded(ma);this.emit('change');break;case h.TRANSFER_UPDATED:this.handleTransferUpdated(ma);this.emit('change');break;case h.TRANSFER_ACCEPTED:this.handleTransferAccepted();this.emit('change');break;case h.TRANSFER_DECLINED:this.handleTransferDeclined(ma);this.emit('change');break;}};ka.prototype.getAsyncRequestState=function(){return da;};ka.prototype.handleTransfersUpdated=function(la){ca=null;fa=true;x=la.map(function(ma){var na={};if(ma.creditCard){na[j.CREDENTIAL_ID]=ma.creditCard[j.CREDENTIAL_ID];na[j.CARD_NUMBER]=ma.creditCard[j.CARD_NUMBER];na[j.CARD_TYPE]=ma.creditCard[j.CARD_TYPE];ma.creditCard=new p(na);}return new l(ma);});};ka.prototype.handleTransfersUpdatedError=function(la){ca=la.error;ha(la.requestID,la.error);};ka.prototype.handleNUXTransfersUpdated=function(la){if(!fa)this.handleTransfersUpdated(la);};ka.prototype.handleTransferAdded=function(la){var ma=null;ga(la.requestID,la);ma=x.filter(function(na){return (na[s.TRANSFER_ID]===la[s.TRANSFER_ID]);})[0];if(ma)return;x.push(new l(la));x=x.sort(function(na,oa){return oa.creationTime-na.creationTime;});};ka.prototype.handleTransferAddedError=function(la){ha(la.requestID,la.errors);};ka.prototype.handleChannelTransferStatusChanged=function(la,ma){ma=ma.obj;m.transferUpdated(ma);};ka.prototype.getPendingMessageAttachment=function(){return ea;};ka.prototype.handleMessageReceived=function(la,ma){for(var na in ma)if(ma.hasOwnProperty(na)){var oa=ma[na];for(var pa=0;pa<oa.length;pa++)if(oa[pa].attachments&&oa[pa].attachments.length){ea=oa[pa];return;}}};ka.prototype.handleMessageUpdated=function(la,ma){if(!ea)return;for(var na in ma)if(ma.hasOwnProperty(na)){var oa=ma[na];for(var pa in oa)if(oa.hasOwnProperty(pa)&&ea.message_id===pa){var qa=r.getTransferFromMessage(ea);if(qa){m.transferAdded(qa);ea=null;return;}}}};ka.prototype.handleTransferUpdated=function(la){for(var ma=0,na=x.length;ma<na;ma++)if(x[ma][s.TRANSFER_ID]===la[s.TRANSFER_ID])x[ma]=l.set(x[ma],la);};ka.prototype.handleTransferAccepted=function(){var la;for(var ma=0,na=x.length;ma<na;ma++)if(x[ma][s.STATUS]===t.PENDING_RECIPIENT_NUX){la={};la[s.STATUS]=t.COMPLETED;x[ma]=l.set(x[ma],la);}};ka.prototype.handleTransferDeclined=function(la){var ma;for(var na=0,oa=x.length;na<oa;na++)if(x[na][s.TRANSFER_ID]===la[s.TRANSFER_ID]&&x[na][s.STATUS]===t.PENDING_RECIPIENT_NUX){ma={};ma[s.STATUS]=t.CANCELED_DECLINED;x[na]=l.set(x[na],ma);break;}};ka.prototype.handleTransferUpdatedError=function(la){ha(la.requestID,la.errors);};ka.prototype.getTransferByID=function(la){return x.filter(function(ma){return la===ma[s.TRANSFER_ID];})[0];};ka.prototype.getAll=function(la){if(!v){v=true;n.getTransactions(la);}return x;};ka.prototype.getNUXTransfer=function(){var la=x.filter(function(ma){return r.isRecipientActionableStatus(ma);})[0];if(!la&&!w&&!v){w=true;n.getNUXTransactions();}return la;};ka.prototype.hasTransfers=function(){return x.length>0;};ka.prototype.hasReceivedFromSender=function(la){for(var ma=0,na=x.length;ma<na;ma++)if(x[ma].sender.id===la)return true;return false;};ka.prototype.getTransferFetchError=function(){return ca;};e.exports=new ka();},null);